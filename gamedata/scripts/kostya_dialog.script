-- -*- mode: lua; coding: windows-1251-dos -*-

function attach( sm )
  sm:subscribe({ signal = "on_first_update", fun = this.on_first_update })
end


function on_first_update()
  if has_alife_info( "peshera_go" ) then
    ogse_signals.get_mgr():subscribe({
      signal = "on_take", fun = this.peshera_go
    })
  end
end


-- stealth
function stealth_start()
	amk.start_timer("run",1.0,"kostya_dialog.stealth_start2()")
end
function stealth_start2()
	level.add_pp_effector ("teleport.ppe", 2006, false)
	xr_sound.get_safe_sound_object([[anomaly\teleport_work_1]]):play_no_feedback(db.actor, sound_object.s2d, 0, vector(), 1.0)
	alife():create("tm_brother_labirint",vector():set(-313.31903076172,62.234169006348,202.46311950684),38734,2987)
end
function stealth1_have()
	local obj = snp.object_by_section_offline("arhara_seif")
	if obj then
		alife():release(obj)
	end
	news_manager.relocate_item(db.actor, "out", "arhara_seif")
end
function stealth1_done()
	amk.start_timer("run",0.5,"kostya_dialog.stealth1_done2()")
end
function stealth1_done2()
	level.add_pp_effector ("teleport.ppe", 2006, false)
	xr_sound.get_safe_sound_object([[anomaly\teleport_work_1]]):play_no_feedback(db.actor, sound_object.s2d, 0, vector(), 1.0)
	alife():release(alife():object(snp.object_by_section("tm_brother_labirint"):id()))
	tm_brother_2chaes_spawn()
end
function tm_brother_2chaes_spawn()
	local se_obj = alife():create("tm_brother_2chaes",vector():set(84.960639953613,8.7271690368652,113.30625152588),56965,2566)
	snp.set_stalker_story_id(se_obj,9969)
end
function stealth2_done()
	alife():create("s_inventory_box_stealth1",vector():set(157.05128479004,12.03516960144,82.391082763672),39526,1229)
	alife():create("s_inventory_box_stealth2",vector():set(-73.545913696289,15.663717269897,2.5357427597046),129042,319)
	alife():create("s_inventory_box_stealth3",vector():set(-136.37683105469,9.9986381530762,-196.55345275879),102496,629)
	alife():create("s_inventory_box_stealth4",vector():set(3.6388249874115,-7.1780724525452,-17.246803207397),312192,1585)
	alife():create("s_inventory_box_stealth5",vector():set(23.35853767395,0.18157379329205,-24.917425918579),209456,1046)
end
function stealth5_done()
	sak.create_items_actor("arhara_seif",1)
	local obj = snp.object_by_section_offline("tm_brother_2chaes")
	if obj then
		alife():release(obj)
	end
end
-- проверка на провал при убийстве, сняти амулета или одевании маскхалата
function stealth_fail_task(victim, who)
	if has_alife_info("stealth2_done") and not has_alife_info("stealth_find_pda_done") and (not who or who:id() == db.actor:id()) then
		db.actor:give_info_portion("stealth_find_pda_fail")
	end
end
-- подъем рюкзака
function stealth_on_take(box)
	local section = box:section()
	if string.find(section, "s_inventory_box_stealth") then
		db.actor:give_info_portion("stealth_find_pda_have"..string.sub(section,24,24))
	end
end
-- сдача ПДА
function stealth_find_pda_done()
	sak.out_item_all("stealth_pda")
end
function stealth_blow_sidor_done()
	sak.create_items_actor("wpn_aks74_kalibr_ves_otdaca",1)
	sak.create_items_actor("wpn_gp100",1)
	braad_test.lab_sar()
end

function krest_topor()
local b = {
	{position={x=-90.577209472656,y=4.2523427009583,z=89.188056945801},gv=2881,lv=115499},
	{position={x=116.68508911133,y=-0.00091594457626343,z=103.09552001953},gv=2885,lv=282454},
	{position={x=44.239944458008,y=-0.0053302049636841,z=16.853719711304},gv=2885,lv=224518}
}
    local a = b[math.random(#b)]
    alife():create("skelet_ded", vector():set(a.position.x,a.position.y,a.position.z), a.lv, a.gv)
end

local peshera_table
local function init_peshera_table()
	if peshera_table == nil then
		peshera_table = xr_logic.pstor_get_custom(db.actor, "peshera_clear", "peshera_clear")
	end
end

function peshera_drink(obj)
	if obj:section() == "snotvornoe_tele" then
		peshera_start()
	elseif obj:section() == "shaxter_tele" then
		peshera_end()
	end
end

function peshera_go(obj)
	if has_alife_info("peshera_go") and obj:section() ~= "separator" then
		init_peshera_table()
		peshera_table[obj:id()] = true
	end
end

function peshera_start()
	local box = obj_by_name("level_prefix_inventory_box_0003")
	if box then
		db.actor:give_info_portion("biznes_remove_special_item")
		db.actor:iterate_inventory(
			function(dummy,item)
				if not protected_items.actor_items_keep(item:section()) then
					db.actor:transfer_item(level.object_by_id(item:id()), box)
				end
			end
		,db.actor)
		alife():create("zamok", vector():set(0,0,0), 0, 0, box:id())
		db.actor:disable_info_portion("biznes_remove_special_item")
	end
	
	create_teleport("peshera_blok_tp",vector():set(-112.609199523926,-9.9281539916992,-34.9218902587891),12288,2868)

	db.actor:give_info_portion("peshera_go")
	init_peshera_table()
	if level.get_game_difficulty() < 2 then
		snp.invul_on()
	end
end

function peshera_end()
	snp.invul_off()
	db.actor:give_info_portion("biznes_remove_special_item")
	db.actor:iterate_inventory(
		function(dummy,item)
			if not protected_items.actor_items_keep(item:section()) then
				alife():release(alife():object(item:id()))
			end
		end
	,db.actor)
	
	local obj
	init_peshera_table()
	for k,v in pairs(peshera_table) do
		obj = alife():object(k)
		if obj and obj.parent_id ~= db.actor:id() and not protected_items.actor_items_keep(obj:section_name()) then
			alife():release(obj)
		end
	end
	db.actor:disable_info_portion("biznes_remove_special_item")
	xr_logic.pstor_clear_custom(db.actor, "peshera_clear")

	for id,obj in pairs(db.creatures) do
		if obj and IAmAMonster[obj:clsid()] then
			alife():release(alife():object(id))
		end
	end

	for i=1,65535 do
		obj = alife():object(i)
		if obj then
			if obj:section_name() == "af_part_monolit" or obj:section_name() == "m_inventory_box16" then
				alife():release(obj)
			elseif
                          obj:section_name() == "dsh_treasure_item"
                          and object_level_name( obj ) == "peshera"
                        then
                          dsh_rukzak.save_rukzak( obj.id, {} )
                          alife():release( obj )
			end
		end
	end

	delete_teleport("peshera_blok_tp")
	db.actor:disable_info_portion("peshera_go")
end

-- Поиск онлайнового объекта по его name в all.spawn
function obj_by_name(name)
	local obj
	for id=1, 65534 do
		obj = level.object_by_id(id)
		if obj and obj:name() == name then
--			get_console():execute("load ~~~ id:"..obj:id())
			return obj
		end
	end
end


function kuv_hit( who )
  if
    ( not db.actor:active_item() ) or ( not who or who:id() ~= db.actor:id() )
  then
    return
  end

  local wpn         = db.actor:active_item()
  local wpn_id      = wpn:id()
  local active_slot = db.actor:active_slot()
	
  -- Падение выносливости от кувалды
  if wpn:section() == "wpn_kuvalda" then
    db.actor.power = -level.get_game_difficulty() / 10
  end

  -- Износ холодного оружия
  if
    active_slot == 0
    and
    get_string( wpn:section(), "hit_type_2" ) ~= "wound"
  then
    wpn:set_condition( wpn:condition() - level.get_game_difficulty() * 0.001 )
  end

  -- Поломка холодного оружия
  if active_slot == 0 and wpn:condition() < 0.05 then
    dsh.timeout( 200, function()
      remove_wpn( wpn_id )
    end )
	
  -- Взрыв убитого ствола
  elseif
    wpn:condition() < 0.1
    and math.random() < 0.2 - wpn:condition() * 2
    and wpn:section() ~= "wpn_shmel"
  then
    amk_particle.amk_particle({
      particle = "explosions\\explosion_fuelcan",
      pos      = db.actor:position(),
      sound    = [[weapons\t_rgd5_explosion]]
    })
    level.add_pp_effector( "amk_shoot.ppe", 2011, false )
    local h = hit()
    h.draftsman = db.actor
    h.direction = vector_rotate_y( db.actor:direction(), 180 )
    h:bone( "bip01_spine" )
    h.type      = hit.explosion
    h.power     =  60
    h.impulse   = 500
    db.actor:hit( h )
    dsh.timeout( 200, function()
      remove_wpn( wpn_id )
    end )
  end
end


function remove_wpn( id )
  if not id then return end
  local obj = alife():object( id )
  if obj then
    alife():release( obj, true )
  end
end


-- рандомная выдача редких патронов qty раз
function give_ammo( qty )
  local ammo = {
    "ammo_gauss",
    "ammo_minigun",
    "ammo_12x70_kart",
    "ammo_357_ap_mag",
    "ammo_12.7x108",
    "ammo_zhekan_izomorf",
    "ammo_9x39_izomorf",
    "ammo_5.45x39_izomorf"
  }
  for i =1, qty do
    local rnd = dsh.get_next_random(
      script_name() .. ".give_ammo.rnd", table.getn( ammo )
    )
    sak.create_items_actor( ammo[ rnd ], 1 )
  end
end


function checking_taken_item63(obj)
	if not (string.sub(obj:section(),1,7)=="tm_docs") then return end 
	
	if db.actor:object("tm_docs01") and db.actor:object("tm_docs02") and db.actor:object("tm_docs03") and db.actor:object("tm_docs04") and db.actor:object("tm_docs05") and db.actor:object("tm_docs06") and db.actor:object("tm_docs07") and db.actor:object("tm_docs08") and db.actor:object("tm_docs09") and db.actor:object("tm_docs10") and db.actor:object("tm_docs11") and db.actor:object("tm_docs12") and db.actor:object("tm_docs13") then
		if not has_alife_info("tm_find_all") then 
			db.actor:give_info_portion("tm_find_all")
			news_manager.send_tip(db.actor, "%c[255,160,160,160]".."ДРАГУНОВ:".."\\n".."%c[255,255,128,128]Стрелок, пока ты искал записки, я думал над той наводкой, что можно составить из этих слов. У меня получилось следующее:\\nНезыблемое Прекрасное Вечное Озаряет Нас Дарит Покой Счастье Мир Найди Путь Стань Бессмертным\\nОчевидно, что речь идёт об Исполнителе Желаний. Но где там тайник? И ещё: в наводке говорится, что нужно найти путь. Так что, Стрелок, похоже, это не всё. Я вижу новый телепорт в центре Саркофага. Думаю, стоит начать с него.".."".."\n", nil, nil, 30000)
			this.tm_done1()
			spawn_tm_taynik()
			local se_obj = alife():create("tm_teleport_1",vector():set(24.6673412323,56.192798614502,-5.0582308769226),5907,2417)
			xr_logic.pstor_store(db.actor, "tm_teleport_1", se_obj.id)		  
			se_obj = alife():create("tm_teleport_2",vector():set(23.798603057861,70.392623901367,45.316135406494),5395,2417)
			xr_logic.pstor_store(db.actor, "tm_teleport_2", se_obj.id)		  
			spawn_restrictor.tm_sr1()
		end
	end
end
function tm_spawn1()
	alife():create("z_inventory_box01",vector():set(10.472078323364,49.034076690674,-15.613767623901),3388,2417)
	alife():create("z_inventory_box02",vector():set(19.680177688599,48.432109832764,-4.1294741630554),4341,2417)
	alife():create("z_inventory_box03",vector():set(3.4836528301239,56.036026000977,35.414047241211),2518,2405)
	alife():create("z_inventory_box04",vector():set(60.87622833252,53.735683441162,26.076965332031),9266,2417)
	alife():create("z_inventory_box05",vector():set(60.85319519043,53.796840667725,21.076036453247),9788,2417)
	alife():create("z_inventory_box06",vector():set(61.789813995361,60.531970977783,41.451103210449),9966,2402)
	alife():create("z_inventory_box07",vector():set(9.1720209121704,20.386127471924,-11.211741447449),6333,2453)
	alife():create("z_inventory_box08",vector():set(44.268180847168,58.320827484131,-24.319999694824),8050,2417)
	alife():create("z_inventory_box09",vector():set(-19.819829940796,64.045745849609,-31.615013122559),591,2417)
	alife():create("z_inventory_box10",vector():set(80.993240356445,71.973617553711,-40.810508728027),6403,2417)
	alife():create("z_inventory_box11",vector():set(42.494750976563,69.035263061523,38.658748626709),4591,2417)
	alife():create("z_inventory_box12",vector():set(64.846755981445,67.564109802246,45.584968566895),4591,2417)
	alife():create("z_inventory_box13",vector():set(51.092010498047,49.359004974365,-17.654895782471),8798,2416)
end
function tm_done1()
 	amk.remove_item_from_inventory_by_name("tm_docs01",db.actor)
 	amk.remove_item_from_inventory_by_name("tm_docs02",db.actor)
 	amk.remove_item_from_inventory_by_name("tm_docs03",db.actor)
 	amk.remove_item_from_inventory_by_name("tm_docs04",db.actor)
 	amk.remove_item_from_inventory_by_name("tm_docs05",db.actor)
 	amk.remove_item_from_inventory_by_name("tm_docs06",db.actor)
 	amk.remove_item_from_inventory_by_name("tm_docs07",db.actor)
 	amk.remove_item_from_inventory_by_name("tm_docs08",db.actor)
 	amk.remove_item_from_inventory_by_name("tm_docs09",db.actor)
 	amk.remove_item_from_inventory_by_name("tm_docs10",db.actor)
 	amk.remove_item_from_inventory_by_name("tm_docs11",db.actor)
 	amk.remove_item_from_inventory_by_name("tm_docs12",db.actor)
 	amk.remove_item_from_inventory_by_name("tm_docs13",db.actor)
end
function checking_taken_item64(obj)
	if obj:section() == "tm_docs14" then
		db.actor:give_info_portion("tm_find_done")
		this.delete_teleport("tm_teleport_4")
		news_manager.send_tip(db.actor, "Найдена информация.", nil, nil, 20000)
		alife():create("z_inventory_box15",vector():set(84.50724029541,69.478454589844,-7.1580576896667),6048,2417)
		amk.drop_item(db.actor,obj)
		amk.remove_item(obj)
	end
end
function spawn_tm_taynik()
	alife():create("z_inventory_box14",vector():set(23.798603057861,70.392623901367,45.316135406494),5395,2417)
end
function remove_tm_taynik()
	alife():release(snp.object_by_section_offline("z_inventory_box14"))
end

-- универсальная процедура спавна телепортов
function create_teleport(section, pos, lv, gv)
    local se_obj = alife():create(section, pos, lv, gv)
	xr_logic.pstor_store(db.actor, section, se_obj.id)
	return se_obj
end
-- универсальная процедура удаления телепортов
function delete_teleport(section)
	local se_obj = alife():object(xr_logic.pstor_retrieve(db.actor, section, -1, true))
	if se_obj then
		alife():release(se_obj, true)
	end
end

function feed_actor()   -- кормим перед сном
	se_obj = alife():create("kolbasa_sleep",db.actor:position(),db.actor:level_vertex_id(),db.actor:game_vertex_id(),db.actor:id())
	amk.start_timer("sleep_feed_actor",0.1,0)
end
function sleep_feed_actor()
	db.actor:eat(db.actor:object("kolbasa_sleep"))
end

-- Proper71 docs
-- Вниманию оптимизаторов: в разделе docs ничего не оптимизировать! Даже не трогать порядок выполнения команд! Из-за использования disable в поршнях и некоторых глюков из-за параллельного выполнения процессов в движке не все работает так, как кажется на первый взгляд. Поэтому ничего здесь не трогайте.
function checking_taken_item61(obj)
	if string.find(obj:section(),"zonedocs") then
		db.actor:give_info_portion("zonedocs_have"..string.sub(obj:section(),string.find(obj:section(),"_")+1))

		local total = 60
		if     has_alife_info("voronin_docs1_start_as") then
			total = 24
		elseif has_alife_info("voronin_docs1_start_yan") then
			total = 23
		elseif has_alife_info("voronin_docs1_start_dt") then
			total = 22
		elseif has_alife_info("voronin_docs1_start_atp") then
			total = 15
		elseif has_alife_info("voronin_docs1_start_td") then
			total = 30
		elseif has_alife_info("voronin_docs1_start_puzir") then
			total = 6
		elseif has_alife_info("voronin_docs1_start_agro") then
			total = 26
		elseif has_alife_info("voronin_docs1_start_marsh") then
			total = 30
		elseif has_alife_info("voronin_docs1_start_esc") then
			total = 60
		elseif has_alife_info("voronin_docs1_start_garbage") then
			total = 60
		elseif has_alife_info("voronin_docs1_start_bar") then
			total = 60
		end
		
		if     new_dialog.item_much("zone_docs",total-1) then
			db.actor:give_info_portion("voronin_docs1_have")
		elseif new_dialog.item_much("zone_docs",total-3) then
			db.actor:give_info_portion("voronin_docs1_almost_have")
		end
		
		amk.remove_item_from_inventory(obj,db.actor)
		-- удаляем дубликаты
		if  (obj:section()=="zonedocs_26" and level.name() == "l03u_agr_underground") or 
			(obj:section()=="zonedocs_22" and (level.name() == "l06_rostok" or level.name() == "l05_bar"))
		then
			local sim = alife()
			local sobj
			for i = 1,65534 do
				sobj = sim:object(i)
				if sobj then
					if  (sobj:section_name() == "zonedocs_26" and level.name() == "l03u_agr_underground") or 
						(sobj:section_name() == "zonedocs_22" and (level.name() == "l06_rostok" or level.name() == "l05_bar"))
					then
						sim:release(sobj,true)
						break
					end
				end
			end
		end
		
		new_dialog.create_items(db.actor,"zone_docs",1)
	end
end

function zonedocs_buy()
	sak.create_items_actor("zonedocs_0",1)
	db.actor:give_info_portion("acv_docs_fail")
end

function voronin_docs1_done()
	sak.out_item_all("zone_docs")
	if not has_alife_info("voronin_docs1_have") then -- удаляем ненайденные части
		local sim = alife()
		local sobj
		for i = 1,65534 do
			sobj = sim:object(i)
			if sobj and string.find(sobj:name(),"zonedocs") then
				sim:release(sobj,true)
			end
		end
	end
	
	if     has_alife_info("voronin_docs1_start_as") then
		if has_alife_info("voronin_docs1_have") then
			db.actor:give_info_portion("voronin_docs1_done_as")
		else
			db.actor:give_info_portion("voronin_docs1_fail_as")
			db.actor:give_info_portion("acv_docs_fail")
		end
	elseif has_alife_info("voronin_docs1_start_yan") then
		if has_alife_info("voronin_docs1_have") then
			db.actor:give_info_portion("voronin_docs1_done_yan")
		else
			db.actor:give_info_portion("voronin_docs1_fail_yan")
			db.actor:give_info_portion("acv_docs_fail")
		end
	elseif has_alife_info("voronin_docs1_start_dt") then
		if has_alife_info("voronin_docs1_have") then
			db.actor:give_info_portion("voronin_docs1_done_dt")
		else
			db.actor:give_info_portion("voronin_docs1_fail_dt")
			db.actor:give_info_portion("acv_docs_fail")
		end
	elseif has_alife_info("voronin_docs1_start_atp") then
		if has_alife_info("voronin_docs1_have") then
			db.actor:give_info_portion("voronin_docs1_done_atp")
		else
			db.actor:give_info_portion("voronin_docs1_fail_atp")
			db.actor:give_info_portion("acv_docs_fail")
		end
	elseif has_alife_info("voronin_docs1_start_td") then
		if has_alife_info("voronin_docs1_have") then
			db.actor:give_info_portion("voronin_docs1_done_td")
		else
			db.actor:give_info_portion("voronin_docs1_fail_td")
			db.actor:give_info_portion("acv_docs_fail")
		end
	elseif has_alife_info("voronin_docs1_start_puzir") then
		if has_alife_info("voronin_docs1_have") then
			db.actor:give_info_portion("voronin_docs1_done_puzir")
		else
			db.actor:give_info_portion("voronin_docs1_fail_puzir")
			db.actor:give_info_portion("acv_docs_fail")
		end
	elseif has_alife_info("voronin_docs1_start_agro") then
		if has_alife_info("voronin_docs1_have") then
			db.actor:give_info_portion("voronin_docs1_done_agro")
		else
			db.actor:give_info_portion("voronin_docs1_fail_agro")
			db.actor:give_info_portion("acv_docs_fail")
		end
	elseif has_alife_info("voronin_docs1_start_marsh") then
		if has_alife_info("voronin_docs1_have") then
			db.actor:give_info_portion("voronin_docs1_done_marsh")
		else
			db.actor:give_info_portion("voronin_docs1_fail_marsh")
			db.actor:give_info_portion("acv_docs_fail")
		end
	elseif has_alife_info("voronin_docs1_start_esc") then
		if has_alife_info("voronin_docs1_have") then
			db.actor:give_info_portion("voronin_docs1_done_esc")
		else
			db.actor:give_info_portion("voronin_docs1_fail_esc")
			db.actor:give_info_portion("acv_docs_fail")
		end
	elseif has_alife_info("voronin_docs1_start_garbage") then
		if has_alife_info("voronin_docs1_have") then
			db.actor:give_info_portion("voronin_docs1_done_garbage")
		else
			db.actor:give_info_portion("voronin_docs1_fail_garbage")
			db.actor:give_info_portion("acv_docs_fail")
		end
	elseif has_alife_info("voronin_docs1_start_bar") then
		if has_alife_info("voronin_docs1_have") then
			db.actor:give_info_portion("voronin_docs1_done_bar")
		else
			db.actor:give_info_portion("voronin_docs1_fail_bar")
			db.actor:give_info_portion("acv_docs_fail")
		end
	end
	
	if has_alife_info("zonedocs_have0") then
		db.actor:give_info_portion("acv_docs_fail")
	end
	if has_alife_info("voronin_docs1_have") then
		this.give_ammo(3)
	end
	db.actor:give_info_portion("voronin_docs1_reset")
end

function t_zonedocs_bar()
	taynik_spawn.t_zonedocs("bar")
end
function t_zonedocs_garbage()
	taynik_spawn.t_zonedocs("garbage")
end
function t_zonedocs_esc()
	taynik_spawn.t_zonedocs("esc")
end
function t_zonedocs_marsh()
	taynik_spawn.t_zonedocs("marsh")
end
function t_zonedocs_agro()
	taynik_spawn.t_zonedocs("agro")
end
function t_zonedocs_puzir()
	taynik_spawn.t_zonedocs("puzir")
end
function t_zonedocs_td()
	taynik_spawn.t_zonedocs("td")
end
function t_zonedocs_atp()
	taynik_spawn.t_zonedocs("atp")
end
function t_zonedocs_dt()
	taynik_spawn.t_zonedocs("dt")
end
function t_zonedocs_yan()
	taynik_spawn.t_zonedocs("yan")
end
function t_zonedocs_as()
	taynik_spawn.t_zonedocs("as")
end

function zonedocs_give_info_2()
	if has_alife_info("zonedocs_have1") then
		db.actor:give_info_portion("zonedocs_have2")
	end
end
function zonedocs_dolg_vrag()
	db.actor:give_info_portion("voronin_docs1_end_fail")
	relation_registry.set_community_goodwill ("dolg", db.actor:id(), -5000)
end
function zonedocs_gg_death()
	db.actor:give_info_portion("voronin_docs1_end_fail")
	amk.start_timer("zonedocs_gg_kill",15,0)
	level.add_cam_effector("camera_effects\\radar_stop.anm", 2506, false, "")
end
function zonedocs_gg_kill()
	db.actor:kill(db.actor)
end
function zonedocs_gg_reward()
	this.give_ammo(30)
	sak.create_items_actor("wpn_svt40",1)
	sak.create_items_actor("wpn_pps43",1)
	sak.create_items_actor("wpn_mkb_42",1)
	sak.create_items_actor("wpn_kedr",1)
	sak.create_items_actor("wpn_sig_m2",1)
	sak.create_items_actor("wpn_sayga_un",1)
	sak.create_items_actor("wpn_mauser_red9",1)
	archievements.acv_docs()
end

function kostya_biznes1_have_all()
	return
		new_dialog.item_much("af_buliz",5)
end		
function kostya_biznes1_have()
	if kostya_biznes1_have_all() then
		db.actor:give_info_portion("kostya_biznes1_have")
		return true
	else
		return false
	end
end
function kostya_biznes1_done()
		sak.out_item_namber("af_buliz",5)
	db.actor:give_info_portion("info_amk_recipt_power_2")
end

function sidor_biznes_over()
	return not (
		has_alife_info("sidor_biznes1_done") and 
		has_alife_info("sidor_biznes2_done") and 
		has_alife_info("sidor_biznes3_done") and 
		has_alife_info("sidor_biznes4_done") and
		has_alife_info("sidor_biznes5_done") and
		has_alife_info("sidor_biznes6_done") and
		has_alife_info("sidor_biznes7_done")
	)
end

function sidor_biznes1_have_all()
	return has_alife_info("sidor_biznes1_start") and
		new_dialog.item_much("mutant_spider_gland",2) and
		new_dialog.item_much("mutant_rotan_heart",2) and
		new_dialog.item_much("mutant_plague_hand",2) and
		new_dialog.item_much("mutant_carlic_hand",2) and
		new_dialog.item_much("mutant_raptor_kogot",2) and
		new_dialog.item_much("mutant_zanoza_leg",2) and
		new_dialog.item_much("mutant_flesh_eye",2) and
		new_dialog.item_much("mutant_boar_leg",2) and
		new_dialog.item_much("mutant_dog_tail",2) and
		new_dialog.item_much("mutant_psevdodog_tail",2) and
		new_dialog.item_much("mutant_krovosos_jaw",2) and
		new_dialog.item_much("mutant_burer_hand",2) and
		new_dialog.item_much("mutant_zombie_hand",2) and
		new_dialog.item_much("mutant_snork_leg",2) and
		new_dialog.item_much("mutant_face_tushkano",2) and
		new_dialog.item_much("mutant_hand_kontroler",2) and
		new_dialog.item_much("mutant_poltergeist_glas",2) and
		new_dialog.item_much("mutant_psevdogigant_hand",2) and
		new_dialog.item_much("mutant_tail_cat",2) and
		new_dialog.item_much("mutant_chimera_kogot",2) and
		new_dialog.item_much("mutant_fracture_hand",2) and
		new_dialog.item_much("mutant_deathclaw_antler",2) and
		new_dialog.item_much("part_digitis_biblio",2) and
		new_dialog.item_much("mutant_vypolzen_hrebet",2) and
		new_dialog.item_much("part_tarakan",2) and
		new_dialog.item_much("part_tarakan_strong",2) and
		new_dialog.item_much("mutant_zombie_teeth",2) and
		new_dialog.item_much("mutant_spleen_rat",2) and
		new_dialog.item_much("mutant_krovosos_red_jaw",1) and
		new_dialog.item_much("mutant_burer_red_hand",1) and
		new_dialog.item_much("bezoar",2) and
		new_dialog.item_much("mushroom",2) and
		new_dialog.item_much("bread_a",2)
end		
function sidor_biznes1_have()
	if sidor_biznes1_have_all() then
		db.actor:give_info_portion("sidor_biznes1_have")
		return true
	else
		return false
	end
end
function sidor_biznes1_done()
		sak.out_item_namber("mutant_spider_gland",2)
		sak.out_item_namber("mutant_rotan_heart",2)
		sak.out_item_namber("mutant_plague_hand",2)
		sak.out_item_namber("mutant_carlic_hand",2)
		sak.out_item_namber("mutant_raptor_kogot",2)
		sak.out_item_namber("mutant_zanoza_leg",2)
		sak.out_item_namber("mutant_flesh_eye",2)
		sak.out_item_namber("mutant_boar_leg",2)
		sak.out_item_namber("mutant_dog_tail",2)
		sak.out_item_namber("mutant_psevdodog_tail",2)
		sak.out_item_namber("mutant_krovosos_jaw",2)
		sak.out_item_namber("mutant_burer_hand",2)
		sak.out_item_namber("mutant_zombie_hand",2)
		sak.out_item_namber("mutant_snork_leg",2)
		sak.out_item_namber("mutant_face_tushkano",2)
		sak.out_item_namber("mutant_hand_kontroler",2)
		sak.out_item_namber("mutant_poltergeist_glas",2)
		sak.out_item_namber("mutant_psevdogigant_hand",2)
		sak.out_item_namber("mutant_tail_cat",2)
		sak.out_item_namber("mutant_chimera_kogot",2)
		sak.out_item_namber("mutant_fracture_hand",2)
		sak.out_item_namber("mutant_deathclaw_antler",2)
		sak.out_item_namber("part_digitis_biblio",2)
		sak.out_item_namber("mutant_vypolzen_hrebet",2)
		sak.out_item_namber("part_tarakan",2)
		sak.out_item_namber("part_tarakan_strong",2)
		sak.out_item_namber("mutant_zombie_teeth",2)
		sak.out_item_namber("mutant_spleen_rat",2)
		sak.out_item_namber("mutant_krovosos_red_jaw",1)
		sak.out_item_namber("mutant_burer_red_hand",1)
		sak.out_item_namber("bezoar",2)
		sak.out_item_namber("mushroom",2)
		sak.out_item_namber("bread_a",2)
	this.give_ammo(10)
	sak.create_items_actor("af_power",1)
	sak.create_items_actor("cube_chip",1)
end

function sidor_biznes2_have_all()
	return has_alife_info("sidor_biznes2_start") and
		new_dialog.item_much("af_dummy_battery_red",3) and
		new_dialog.item_much("af_dummy_spring_red",3) and
		new_dialog.item_much("af_dummy_pellicle_red",3) and
		new_dialog.item_much("af_caterpillar",4) and
		new_dialog.item_much("af_simbion",2) and
		new_dialog.item_much("af_arhara_globus",1) and
		new_dialog.item_much("bread_a",3)
end
function sidor_biznes2_have()
	if sidor_biznes2_have_all() then
		db.actor:give_info_portion("sidor_biznes2_have")
		return true
	else
		return false
	end
end
function sidor_biznes2_done()
		sak.out_item_namber("af_dummy_battery_red",3)
		sak.out_item_namber("af_dummy_spring_red",3)
		sak.out_item_namber("af_dummy_pellicle_red",3)
		sak.out_item_namber("af_caterpillar",4)
		sak.out_item_namber("af_simbion",2)
		sak.out_item_namber("af_arhara_globus",1)
		sak.out_item_namber("bread_a",3)
	this.give_ammo(5)
	sak.create_items_actor("cube_chip",1)
	db.actor:give_info_portion("info_amk_recipt_power_3")
end

function sidor_biznes3_have_all()
	return has_alife_info("sidor_biznes3_start") and
		new_dialog.item_much("af_buliz",15) and
		new_dialog.item_much("af_drops",1) and
		new_dialog.item_much("af_cry_1",1) and
		new_dialog.item_much("af_cry_2",1) and
		new_dialog.item_much("af_cry_3",2) and
		new_dialog.item_much("af_dummy_glassbeads",1) and
		new_dialog.item_much("af_babka_1",1) and
		new_dialog.item_much("af_babka_2",1) and
		new_dialog.item_much("af_babka_3",2) and
		new_dialog.item_much("af_babka_4",2) and
		new_dialog.item_much("af_rusty_sea-urchin",1) and
		new_dialog.item_much("af_dik_1",1) and
		new_dialog.item_much("af_dik_2",1) and
		new_dialog.item_much("af_dik_3",2) and
		new_dialog.item_much("af_dik_4",2) and
		new_dialog.item_much("af_soul",1) and
		new_dialog.item_much("af_spirit_1",1) and
		new_dialog.item_much("af_spirit_2",1) and
		new_dialog.item_much("af_spirit_3",2) and
		new_dialog.item_much("af_spirit_4",2) and
		new_dialog.item_much("af_dummy_pellicle",1) and
		new_dialog.item_much("af_armor_1",1) and
		new_dialog.item_much("af_armor_2",1) and
		new_dialog.item_much("af_armor_3",2) and
		new_dialog.item_much("af_armor_4",2) and
		new_dialog.item_much("af_dummy_dummy",1) and
		new_dialog.item_much("af_pudd_1",1) and
		new_dialog.item_much("af_pudd_2",1) and
		new_dialog.item_much("af_pudd_3",2) and
		new_dialog.item_much("af_pudd_4",2) and
		new_dialog.item_much("af_fuzz_kolobok",1) and
		new_dialog.item_much("af_kol_1",1) and
		new_dialog.item_much("af_kol_2",1) and
		new_dialog.item_much("af_kol_3",2) and
		new_dialog.item_much("af_kol_4",2)
end
function sidor_biznes3_have()
	if sidor_biznes3_have_all()	then
		db.actor:give_info_portion("sidor_biznes3_have")
		return true
	else
		return false
	end
end
function sidor_biznes3_done()
		sak.out_item_namber("af_buliz",15)
		sak.out_item_namber("af_drops",1)
		sak.out_item_namber("af_cry_1",1)
		sak.out_item_namber("af_cry_2",1)
		sak.out_item_namber("af_cry_3",2)
		sak.out_item_namber("af_dummy_glassbeads",1)
		sak.out_item_namber("af_babka_1",1)
		sak.out_item_namber("af_babka_2",1)
		sak.out_item_namber("af_babka_3",2)
		sak.out_item_namber("af_babka_4",2)
		sak.out_item_namber("af_rusty_sea-urchin",1)
		sak.out_item_namber("af_dik_1",1)
		sak.out_item_namber("af_dik_2",1)
		sak.out_item_namber("af_dik_3",2)
		sak.out_item_namber("af_dik_4",2)
		sak.out_item_namber("af_soul",1)
		sak.out_item_namber("af_spirit_1",1)
		sak.out_item_namber("af_spirit_2",1)
		sak.out_item_namber("af_spirit_3",2)
		sak.out_item_namber("af_spirit_4",2)
		sak.out_item_namber("af_dummy_pellicle",1)
		sak.out_item_namber("af_armor_1",1)
		sak.out_item_namber("af_armor_2",1)
		sak.out_item_namber("af_armor_3",2)
		sak.out_item_namber("af_armor_4",2)
		sak.out_item_namber("af_dummy_dummy",1)
		sak.out_item_namber("af_pudd_1",1)
		sak.out_item_namber("af_pudd_2",1)
		sak.out_item_namber("af_pudd_3",2)
		sak.out_item_namber("af_pudd_4",2)
		sak.out_item_namber("af_fuzz_kolobok",1)
		sak.out_item_namber("af_kol_1",1)
		sak.out_item_namber("af_kol_2",1)
		sak.out_item_namber("af_kol_3",2)
		sak.out_item_namber("af_kol_4",2)
	this.give_ammo(30)
	sak.create_items_actor("wpn_m_134",1)
	sak.create_items_actor("wpn_pkm",1)
	sak.create_items_actor("cube_chip",1)
end


function sidor_biznes4_have_all()
  return has_alife_info( "sidor_biznes4_start" )
    and amk_utils.good_items_have_number({
      [ "wpn_gauss" ] = 6,
      [ "wpn_rpg7"  ] = 3,
    })
    and new_dialog.item_much( "ammo_gauss", 10 )
    and new_dialog.item_much( "ammo_super_gauss", 15 )
    and new_dialog.item_much( "ammo_og-7b", 30 )
end


function sidor_biznes4_have()
	if sidor_biznes4_have_all() then
		db.actor:give_info_portion("sidor_biznes4_have")
		return true
	else
		return false
	end
end


function sidor_biznes4_done()
  amk_utils.out_good_items_number({
    [ "wpn_gauss" ] = 6,
    [ "wpn_rpg7"  ] = 3,
  })
  sak.out_item_namber( "ammo_gauss", 10 )
  sak.out_item_namber( "ammo_super_gauss", 15 )
  sak.out_item_namber( "ammo_og-7b", 30 )
  this.give_ammo( 10 )
  sak.create_items_actor( "wpn_m_134", 1 )
  sak.create_items_actor( "wpn_pkm", 1 )
  sak.create_items_actor( "scientist_suit_white", 1 )
  sak.create_items_actor( "cube_chip", 1 )
end


function sidor_biznes5_have_all()
  return has_alife_info( "sidor_biznes5_start" )
    and amk_utils.good_items_have_number({
      [ "broken_exoskeleton"      ] = 2,
      [ "voen_exo_outfit"         ] = 2,
      [ "exo_outfit"              ] = 2,
      [ "killer_blue_exoskeleton" ] = 2,
      [ "monolit_exoskeleton"     ] = 2,
      [ "svoboda_exoskeleton"     ] = 2,
      [ "dolg_black_exoskeleton"  ] = 2,
      [ "nebo_exo_outfit"         ] = 2,
      [ "exo_bandit_outfit"       ] = 2,
      [ "exo_scientist_outfit"    ] = 2,
    })
end


function sidor_biznes5_have()
	if sidor_biznes5_have_all() then
		db.actor:give_info_portion("sidor_biznes5_have")
		return true
	else
		return false
	end
end


function sidor_biznes5_done()
  amk_utils.out_good_items_number({
    [ "broken_exoskeleton"      ] = 2,
    [ "voen_exo_outfit"         ] = 2,
    [ "exo_outfit"              ] = 2,
    [ "killer_blue_exoskeleton" ] = 2,
    [ "monolit_exoskeleton"     ] = 2,
    [ "svoboda_exoskeleton"     ] = 2,
    [ "dolg_black_exoskeleton"  ] = 2,
    [ "nebo_exo_outfit"         ] = 2,
    [ "exo_bandit_outfit"       ] = 2,
    [ "exo_scientist_outfit"    ] = 2,
  })
  this.give_ammo( 10 )
  sak.create_items_actor( "wpn_m_134", 1 )
  sak.create_items_actor( "wpn_vepr12_m1", 1 )
  sak.create_items_actor( "cube_chip", 1 )
end


function sidor_biznes6_have_all()
  return has_alife_info( "sidor_biznes6_start" )
    and amk_utils.good_items_have_number({
      [ "wpn_crossbow" ] = 5,
      [ "wpn_awm"      ] = 5,
      [ "wpn_svd"      ] = 2,
      [ "wpn_svu"      ] = 2,
      [ "wpn_vintorez" ] = 5,
    })
    and new_dialog.item_much( "ammo_arbolt", 30 )
    and new_dialog.item_much( "ammo_igl", 15 )
    and new_dialog.item_much( "ammo_7.62x54_7h1", 16 )
    and new_dialog.item_much( "ammo_7.62x54_7h14", 16 )
    and new_dialog.item_much( "ammo_7.62x54_ap", 16 )
    and new_dialog.item_much( "ammo_9x39_sp5", 5 )
    and new_dialog.item_much( "ammo_9x39_ap", 5 )
    and new_dialog.item_much( "ammo_9x39_pab9", 5 )
end


function sidor_biznes6_have()
	if sidor_biznes6_have_all() then
		db.actor:give_info_portion("sidor_biznes6_have")
		return true
	else
		return false
	end
end


function sidor_biznes6_done()
  amk_utils.out_good_items_number({
   [ "wpn_crossbow" ] = 5,
   [ "wpn_awm"      ] = 5,
   [ "wpn_svd"      ] = 2,
   [ "wpn_svu"      ] = 2,
   [ "wpn_vintorez" ] = 5,
 })
  sak.out_item_namber( "ammo_arbolt", 30 )
  sak.out_item_namber( "ammo_igl", 15 )
  sak.out_item_namber( "ammo_7.62x54_7h1", 16 )
  sak.out_item_namber( "ammo_7.62x54_7h14", 16 )
  sak.out_item_namber( "ammo_7.62x54_ap", 16 )
  sak.out_item_namber( "ammo_9x39_sp5", 5 )
  sak.out_item_namber( "ammo_9x39_ap", 5 )
  sak.out_item_namber( "ammo_9x39_pab9", 5 )
  this.give_ammo( 10 )
  sak.create_items_actor( "wpn_m_134", 1 )
  sak.create_items_actor( "wpn_aks74_m2", 1 )
  sak.create_items_actor( "cube_chip", 1 )
end


function sidor_biznes7_have_all()
	return has_alife_info("sidor_biznes7_start") and
		new_dialog.item_much("mutant_spider_gland",2) and
		new_dialog.item_much("mutant_rotan_heart",2) and
		new_dialog.item_much("mutant_plague_hand",2) and
		new_dialog.item_much("mutant_carlic_hand",2) and
		new_dialog.item_much("mutant_raptor_kogot",2) and
		new_dialog.item_much("mutant_zanoza_leg",2) and
		new_dialog.item_much("mutant_boar_leg",10) and
		new_dialog.item_much("mutant_dog_tail",10) and
		new_dialog.item_much("mutant_psevdodog_tail",20) and
		new_dialog.item_much("mutant_krovosos_jaw",10) and
		new_dialog.item_much("mutant_zombie_hand",20) and
		new_dialog.item_much("mutant_snork_leg",10) and
		new_dialog.item_much("mutant_face_tushkano",20) and
		new_dialog.item_much("mutant_hand_kontroler",20) and
		new_dialog.item_much("mutant_psevdogigant_hand",10) and
		new_dialog.item_much("mutant_tail_cat",10) and
		new_dialog.item_much("mutant_chimera_kogot",20) and
		new_dialog.item_much("mutant_fracture_hand",20) and
		new_dialog.item_much("mutant_deathclaw_antler",10) and
		new_dialog.item_much("part_digitis_biblio",10) and
		new_dialog.item_much("mutant_vypolzen_hrebet",10) and
		new_dialog.item_much("part_tarakan",6) and
		new_dialog.item_much("part_tarakan_strong",20) and
		new_dialog.item_much("mutant_zombie_teeth",10) and
		new_dialog.item_much("rudiment_big",3) and
		new_dialog.item_much("mutant_spleen_rat",20) and
		new_dialog.item_much("mozg",6) and
		new_dialog.item_much("bezoar",6) and
		new_dialog.item_much("bread_a",8)
end		
function sidor_biznes7_have()
	if sidor_biznes7_have_all() then
		db.actor:give_info_portion("sidor_biznes7_have")
		return true
	else
		return false
	end
end
function sidor_biznes7_done()
		sak.out_item_namber("mutant_spider_gland",2)
		sak.out_item_namber("mutant_rotan_heart",2)
		sak.out_item_namber("mutant_plague_hand",2)
		sak.out_item_namber("mutant_carlic_hand",2)
		sak.out_item_namber("mutant_raptor_kogot",2)
		sak.out_item_namber("mutant_zanoza_leg",2)
		sak.out_item_namber("mutant_boar_leg",10)
		sak.out_item_namber("mutant_dog_tail",10)
		sak.out_item_namber("mutant_psevdodog_tail",20)
		sak.out_item_namber("mutant_krovosos_jaw",10)
		sak.out_item_namber("mutant_zombie_hand",20)
		sak.out_item_namber("mutant_snork_leg",10)
		sak.out_item_namber("mutant_face_tushkano",20)
		sak.out_item_namber("mutant_hand_kontroler",20)
		sak.out_item_namber("mutant_psevdogigant_hand",10)
		sak.out_item_namber("mutant_tail_cat",10)
		sak.out_item_namber("mutant_chimera_kogot",20)
		sak.out_item_namber("mutant_fracture_hand",20)
		sak.out_item_namber("mutant_deathclaw_antler",10)
		sak.out_item_namber("part_digitis_biblio",10)
		sak.out_item_namber("mutant_vypolzen_hrebet",10)
		sak.out_item_namber("part_tarakan",6)
		sak.out_item_namber("part_tarakan_strong",20)
		sak.out_item_namber("mutant_zombie_teeth",10)
		sak.out_item_namber("rudiment_big",3)
		sak.out_item_namber("mutant_spleen_rat",20)
		sak.out_item_namber("mozg",6)
		sak.out_item_namber("bezoar",6)
		sak.out_item_namber("bread_a",8)
	this.give_ammo(25)
	sak.create_items_actor("vodka",100)
end

function kuznetsov_biznes1_have_all()
	return
		new_dialog.item_much("wpn_ak47",30) and
		new_dialog.item_much("ammo_7.62x39_fmj",40) and
		new_dialog.item_much("ammo_7.62x39_ap",20)
end		
function kuznetsov_biznes1_have()
	if kuznetsov_biznes1_have_all() then
		db.actor:give_info_portion("kuznetsov_biznes1_have")
		return true
	else
		return false
	end
end
function kuznetsov_biznes1_done()
		sak.out_item_namber("wpn_ak47",30)
		sak.out_item_namber("ammo_7.62x39_fmj",40)
		sak.out_item_namber("ammo_7.62x39_ap",20)
	sak.create_items_actor("sigaret",100)
	sak.create_items_actor("cube_chip",1)
end


function adrenalin_biznes1_have_all1()
  return amk_utils.good_items_have_number({
    [ "wpn_pkm"   ] =  7,
    [ "wpn_m_134" ] = 14,
    [ "wpn_mg42"  ] =  1,
  })
end


function adrenalin_biznes1_have1()
	if adrenalin_biznes1_have_all1() then
		db.actor:give_info_portion("adrenalin_biznes1_have1")
		return true
	else
		return false
	end
end


function adrenalin_biznes1_done1()
  amk_utils.out_good_items_number({
    [ "wpn_pkm"   ] =  7,
    [ "wpn_m_134" ] = 14,
    [ "wpn_mg42"  ] =  1,
  })
  this.adrenalin_biznes1_done()
end


function adrenalin_biznes1_have_all2()
	return
		new_dialog.item_much("ammo_7.62x54r",20) and
		new_dialog.item_much("ammo_minigun",24) and
		new_dialog.item_much("ammo_7.62x51box",10)
end		
function adrenalin_biznes1_have2()
	if adrenalin_biznes1_have_all2() then
		db.actor:give_info_portion("adrenalin_biznes1_have2")
		return true
	else
		return false
	end
end
function adrenalin_biznes1_done2()
		sak.out_item_namber("ammo_7.62x54r",20)
		sak.out_item_namber("ammo_minigun",24)
		sak.out_item_namber("ammo_7.62x51box",10)
		this.adrenalin_biznes1_done()
end
function adrenalin_biznes1_have_all3()
	return	
		new_dialog.item_much("treasure_item",60) and
		new_dialog.item_much("zamok",30)
end		
function adrenalin_biznes1_have3()
	if adrenalin_biznes1_have_all3() then
		db.actor:give_info_portion("adrenalin_biznes1_have3")
		return true
	else
		return false
	end
end
function adrenalin_biznes1_done3()
		db.actor:give_info_portion("biznes_remove_special_item")
		sak.out_item_namber("treasure_item",60)
		sak.out_item_namber("zamok",30)
		db.actor:disable_info_portion("biznes_remove_special_item")
		this.adrenalin_biznes1_done()
end
function adrenalin_biznes1_done()
	if has_alife_info("adrenalin_biznes1_done1") and has_alife_info("adrenalin_biznes1_done2") and has_alife_info("adrenalin_biznes1_done3") then
		sak.create_items_actor("ammo_12.7x108",30)
		sak.create_items_actor("ammo_7.62x39_k",10)
		sak.create_items_actor("ammo_5.56x45_gd",10)
		sak.create_items_actor("ammo_12x70_kart",30)
		sak.create_items_actor("ammo_gauss",30)
		sak.create_items_actor("ammo_super_gauss",30)
		sak.create_items_actor("ammo_balon",10)
		sak.create_items_actor("grenade_f1_double",30)
		sak.create_items_actor("cube_chip",1)
		db.actor:give_info_portion("adrenalin_biznes1_done")
	end
end


function zahar_biznes1_have_all()
  return
    new_dialog.item_much( "amk_metka", 10 )
    and amk_utils.good_items_have_number({
      [ "wpn_saiga12c" ] = 10,
    })
    and new_dialog.item_much( "ammo_12x70_buck", 30 )
    and new_dialog.item_much( "ammo_12x76_dart", 20 )
    and new_dialog.item_much( "ammo_12x76_zhekan", 15 )
    and new_dialog.item_much( "ammo_12x70_kart", 50 )
end


function zahar_biznes1_have()
	if zahar_biznes1_have_all() then
		db.actor:give_info_portion("zahar_biznes1_have")
		return true
	else
		return false
	end
end


function zahar_biznes1_done()
  db.actor:give_info_portion( "biznes_remove_special_item" )
  sak.out_item_namber( "amk_metka", 10 )
  db.actor:disable_info_portion( "biznes_remove_special_item" )
  amk_utils.out_good_items_number({
    [ "wpn_saiga12c" ] = 10,
  })
  sak.out_item_namber( "ammo_12x70_buck", 30 )
  sak.out_item_namber( "ammo_12x76_dart", 20 )
  sak.out_item_namber( "ammo_12x76_zhekan", 15 )
  sak.out_item_namber( "ammo_12x70_kart", 50 )
  this.give_ammo( 10 )
  sak.create_items_actor( "wpn_m_134", 1 )
  sak.create_items_actor( "wpn_pkm", 1 )
  sak.create_items_actor( "cube_chip", 1 )
end


function barman_biznes1_have_all()
	return
		new_dialog.item_much("sweetness",20) and
		new_dialog.item_much("beer_a",20) and
		new_dialog.item_much("cigara",50) and
		new_dialog.item_much("sigaret",100) and
		new_dialog.item_much("vodka",200)
end		
function barman_biznes1_have()
	if barman_biznes1_have_all() then
		db.actor:give_info_portion("barman_biznes1_have")
		return true
	else
		return false
	end
end
function barman_biznes1_done()
		sak.out_item_namber("sweetness",20)
		sak.out_item_namber("beer_a",20)
		sak.out_item_namber("cigara",50)
		sak.out_item_namber("sigaret",100)
		sak.out_item_namber("vodka",200)
	db.actor:give_info_portion("info_amk_recipt_power_1")
	sak.create_items_actor("cube_chip",1)
end


function kruglov_biznes1_have_all()
  return
    amk_utils.good_items_have_number({
      [ "nebo_scientific_outfit" ] = 1,
    })
    and new_dialog.item_much( "af_dik_1", 2 )
    and new_dialog.item_much( "af_dik_2", 2 )
    and new_dialog.item_much( "af_dik_3", 2 )
    and new_dialog.item_much( "af_dik_4", 2 )
    and new_dialog.item_much( "af_spirit_4", 1 )
end


function kruglov_biznes1_have()
	if kruglov_biznes1_have_all() then
		db.actor:give_info_portion("kruglov_biznes1_have")
		return true
	else
		return false
	end
end


function kruglov_biznes1_done()
  amk_utils.out_good_items_number({
    [ "nebo_scientific_outfit" ] = 1,
  })
  sak.out_item_namber( "af_dik_1", 2 )
  sak.out_item_namber( "af_dik_2", 2 )
  sak.out_item_namber( "af_dik_3", 2 )
  sak.out_item_namber( "af_dik_4", 2 )
  sak.out_item_namber( "af_spirit_4", 1 )
  sak.create_items_actor( "wpn_m_134", 1 )
  sak.create_items_actor( "cube_chip", 1 )
end


function yakut_biznes1_have_all()
	return
		new_dialog.item_much("af_simbion",6) and
		new_dialog.item_much("af_armor_4",6) and
		new_dialog.item_much("antizombie",3)
end		
function yakut_biznes1_have()
	if yakut_biznes1_have_all() then
		db.actor:give_info_portion("yakut_biznes1_have")
		return true
	else
		return false
	end
end
function yakut_biznes1_done()
		sak.out_item_namber("af_simbion",6)
		sak.out_item_namber("af_armor_4",6)
		sak.out_item_namber("antizombie",3)
	sak.create_items_actor("wpn_m_134",1)
	sak.create_items_actor("cube_chip",1)
end


function voron_biznes1_have_all()
  return
    amk_utils.good_items_have_number({
      [ "wpn_peceneg"         ] = 8,
      [ "military_outfit"     ] = 4,
      [ "militaryspec_outfit" ] = 4,
    })
    and new_dialog.item_much( "ammo_7.62x54r", 12 )
    and new_dialog.item_much( "medkit_army", 20 )
end


function voron_biznes1_have()
	if voron_biznes1_have_all() then
		db.actor:give_info_portion("voron_biznes1_have")
		return true
	else
		return false
	end
end


function voron_biznes1_done()
  amk_utils.out_good_items_number({
    [ "wpn_peceneg"         ] = 8,
    [ "military_outfit"     ] = 4,
    [ "militaryspec_outfit" ] = 4,
  })
  sak.out_item_namber( "ammo_7.62x54r", 12 )
  sak.out_item_namber( "medkit_army", 20 )
  sak.create_items_actor( "wpn_m_134", 1 )
  sak.create_items_actor( "wpn_rpk47_sk1", 1 )
  sak.create_items_actor( "cube_chip", 1 )
end


function lukash_biznes1_have_all()
  return
    amk_utils.good_items_have_number({
      [ "wpn_rg-6"  ] = 1,
      [ "wpn_groza" ] = 4,
    })
    and new_dialog.item_much( "grenade_f1", 20 )
    and new_dialog.item_much( "grenade_rgd5", 20 )
    and new_dialog.item_much( "grenade_gd-05", 20 )
    and new_dialog.item_much( "ammo_vog-25", 20 )
    and new_dialog.item_much( "ammo_vog-25p", 20 )
    and new_dialog.item_much( "medkit_army", 10 )
    and new_dialog.item_much( "antirad", 10 )
    and new_dialog.item_much( "energy_drink", 20 )
    and new_dialog.item_much( "amk_metka", 5 )
    and new_dialog.item_much( "treasure_item", 5 )
    and new_dialog.item_much( "detector_elite", 1 )
end


function lukash_biznes1_have()
	if lukash_biznes1_have_all() then
		db.actor:give_info_portion("lukash_biznes1_have")
		return true
	else
		return false
	end
end


function lukash_biznes1_done()
  amk_utils.out_good_items_number({
    [ "wpn_rg-6"  ] = 1,
    [ "wpn_groza" ] = 4,
  })
  sak.out_item_namber( "grenade_f1", 20 )
  sak.out_item_namber( "grenade_f1_double", 5 )
  sak.out_item_namber( "grenade_rgd5", 20 )
  sak.out_item_namber( "grenade_gd-05", 20 )
  sak.out_item_namber( "ammo_vog-25", 20 )
  sak.out_item_namber( "ammo_vog-25p", 20 )
  sak.out_item_namber( "antirad", 10 )
  sak.out_item_namber( "medkit_army", 10 )
  sak.out_item_namber( "detector_elite", 1 )
  db.actor:give_info_portion( "biznes_remove_special_item" )
  sak.out_item_namber( "amk_metka", 5 )
  sak.out_item_namber( "treasure_item", 5 )
  sak.out_item_namber( "energy_drink", 20 )
  db.actor:disable_info_portion( "biznes_remove_special_item" )
  this.give_ammo( 10 )
  sak.create_items_actor( "wpn_m_134", 1 )
  sak.create_items_actor( "cube_chip", 1 )
end


function sakharov_biznes1_have_all()
	return
		new_dialog.item_much("caps_mosquito_bald",3) and
		new_dialog.item_much("caps_gravi",3) and
		new_dialog.item_much("caps_mincer",3) and
		new_dialog.item_much("caps_electra",3) and
		new_dialog.item_much("caps_zharka",3) and
		new_dialog.item_much("caps_ameba",3) and
		new_dialog.item_much("caps_ice",3) and
		new_dialog.item_much("mutant_krovosos_cocoon",1) and
		new_dialog.item_much("mutant_burer_cocoon",1) and
		new_dialog.item_much("mutant_zombie_cocoon",1) and
		new_dialog.item_much("mutant_snork_cocoon",1) and
		new_dialog.item_much("mutant_flesh_cocoon",1) and
		new_dialog.item_much("mutant_gigant_cocoon",1) and
		new_dialog.item_much("mutant_poltergeist_cocoon",1) and
		new_dialog.item_much("mutant_psevdodog_cocoon",1) and
		new_dialog.item_much("mutant_dog_cocoon",1) and
		new_dialog.item_much("mutant_controller_cocoon",1) and
		new_dialog.item_much("mutant_chimera_cocoon",1) and
		new_dialog.item_much("mutant_boar_cocoon",1) and
		new_dialog.item_much("mutant_tushkano_cocoon",1) and
		new_dialog.item_much("mutant_psydog_cocoon",1) and
		new_dialog.item_much("mutant_cat_cocoon",1) and
		new_dialog.item_much("bezoar",5)
end		
function sakharov_biznes1_have()
	if sakharov_biznes1_have_all() then
		db.actor:give_info_portion("sakharov_biznes1_have")
		return true
	else
		return false
	end
end
function sakharov_biznes1_done()
		sak.out_item_namber("caps_mosquito_bald",3)
		sak.out_item_namber("caps_gravi",3)
		sak.out_item_namber("caps_mincer",3)
		sak.out_item_namber("caps_electra",3)
		sak.out_item_namber("caps_zharka",3)
		sak.out_item_namber("caps_ameba",3)
		sak.out_item_namber("caps_ice",3)
		sak.out_item_namber("mutant_krovosos_cocoon",1)
		sak.out_item_namber("mutant_burer_cocoon",1)
		sak.out_item_namber("mutant_zombie_cocoon",1)
		sak.out_item_namber("mutant_snork_cocoon",1)
		sak.out_item_namber("mutant_flesh_cocoon",1)
		sak.out_item_namber("mutant_gigant_cocoon",1)
		sak.out_item_namber("mutant_poltergeist_cocoon",1)
		sak.out_item_namber("mutant_psevdodog_cocoon",1)
		sak.out_item_namber("mutant_dog_cocoon",1)
		sak.out_item_namber("mutant_controller_cocoon",1)
		sak.out_item_namber("mutant_chimera_cocoon",1)
		sak.out_item_namber("mutant_boar_cocoon",1)
		sak.out_item_namber("mutant_tushkano_cocoon",1)
		sak.out_item_namber("mutant_psydog_cocoon",1)
		sak.out_item_namber("mutant_cat_cocoon",1)
		sak.out_item_namber("bezoar",5)
	sak.create_items_actor("af_power",1)
	sak.create_items_actor("cube_chip",1)
end

function sak_biznes1_have_all()
	return
		new_dialog.item_much("af_medusa",8) and
		new_dialog.item_much("af_cristall_flower",6) and
		new_dialog.item_much("af_night_star",6) and
		new_dialog.item_much("af_vyvert",7) and
		new_dialog.item_much("af_gravi",12) and
		new_dialog.item_much("af_gold_fish",4) and
		new_dialog.item_much("af_blood",4) and
		new_dialog.item_much("af_mincer_meat",3) and
		new_dialog.item_much("af_soul",7) and
		new_dialog.item_much("af_electra_sparkler",5) and
		new_dialog.item_much("af_electra_flash",5) and
		new_dialog.item_much("af_electra_moonlight",6) and
		new_dialog.item_much("af_rusty_thorn",6) and
		new_dialog.item_much("af_rusty_kristall",8) and
		new_dialog.item_much("af_rusty_sea-urchin",4) and
		new_dialog.item_much("af_ameba_slime",5) and
		new_dialog.item_much("af_ameba_slug",10) and
		new_dialog.item_much("af_ameba_mica",8) and
		new_dialog.item_much("af_drops",9) and
		new_dialog.item_much("af_fireball",4) and
		new_dialog.item_much("af_cristall",4) and
		new_dialog.item_much("af_dummy_glassbeads",6) and
		new_dialog.item_much("af_dummy_pellicle",5) and
		new_dialog.item_much("af_dummy_battery",9) and
		new_dialog.item_much("af_dummy_dummy",6) and
		new_dialog.item_much("af_dummy_spring",7) and
		new_dialog.item_much("af_fuzz_kolobok",4) and
		new_dialog.item_much("af_cry_2",3) and
		new_dialog.item_much("af_arhara_globus",1) and
		new_dialog.item_much("arc_art_box_1basic",3) and
		new_dialog.item_much("arc_art_box_basic",3) and
		new_dialog.item_much("arc_art_box_8basic",3) and
		new_dialog.item_much("zamok",1) and
		new_dialog.item_much("treasure_item",1) and
		new_dialog.item_much("amk_metka",1)
end		
function sak_biznes1_have()
	if sak_biznes1_have_all() then
		db.actor:give_info_portion("sak_biznes1_have")
		return true
	else
		return false
	end
end
function sak_biznes1_done()
		sak.out_item_namber("af_medusa",8)
		sak.out_item_namber("af_cristall_flower",6)
		sak.out_item_namber("af_night_star",6)
		sak.out_item_namber("af_vyvert",7)
		sak.out_item_namber("af_gravi",12)
		sak.out_item_namber("af_gold_fish",4)
		sak.out_item_namber("af_blood",4)
		sak.out_item_namber("af_mincer_meat",3)
		sak.out_item_namber("af_soul",7)
		sak.out_item_namber("af_electra_sparkler",5)
		sak.out_item_namber("af_electra_flash",5)
		sak.out_item_namber("af_electra_moonlight",6)
		sak.out_item_namber("af_rusty_thorn",6)
		sak.out_item_namber("af_rusty_kristall",8)
		sak.out_item_namber("af_rusty_sea-urchin",4)
		sak.out_item_namber("af_ameba_slime",5)
		sak.out_item_namber("af_ameba_slug",10)
		sak.out_item_namber("af_ameba_mica",8)
		sak.out_item_namber("af_drops",9)
		sak.out_item_namber("af_fireball",4)
		sak.out_item_namber("af_cristall",4)
		sak.out_item_namber("af_dummy_glassbeads",6)
		sak.out_item_namber("af_dummy_pellicle",5)
		sak.out_item_namber("af_dummy_battery",9)
		sak.out_item_namber("af_dummy_dummy",6)
		sak.out_item_namber("af_dummy_spring",7)
		sak.out_item_namber("af_fuzz_kolobok",4)
		sak.out_item_namber("af_cry_2",3)
		sak.out_item_namber("af_arhara_globus",1)

		db.actor:give_info_portion("biznes_remove_special_item")
		sak.out_item_namber("amk_metka",1)
		sak.out_item_namber("arc_art_box_1basic",3)
		sak.out_item_namber("arc_art_box_basic",3)
		sak.out_item_namber("arc_art_box_8basic",3)
		sak.out_item_namber("zamok",1)
		sak.out_item_namber("treasure_item",1)
		db.actor:disable_info_portion("biznes_remove_special_item")

	this.give_ammo(10)
	sak.create_items_actor("wpn_m_134",1)
	sak.create_items_actor("cube_chip",1)
end

function skraga_biznes1_have_all()
	return db.actor:money()>=2000000	
end		
function skraga_biznes1_have()
	if skraga_biznes1_have_all() then
		db.actor:give_info_portion("skraga_biznes1_have")
		return true
	else
		return false
	end
end
function skraga_biznes1_done()
	sak.create_items_actor("wpn_m_134",1)
	sak.create_items_actor("cube_chip",1)
end

function doktor_biznes1_have_all()
	return
		new_dialog.item_much("medkit",20) and
		new_dialog.item_much("medkit_army",30) and
		new_dialog.item_much("medkit_scientic",40) and
		new_dialog.item_much("bandage",100) and
		new_dialog.item_much("antirad",50) and
		new_dialog.item_much("antizombie",10) and
		new_dialog.item_much("vodka",20) and
		new_dialog.item_much("af_life_heart",5) and
		new_dialog.item_much("maz",15) and
		new_dialog.item_much("matras",10) and
		new_dialog.item_much("zamok",10) and
		new_dialog.item_much("treasure_item",10) and
		new_dialog.item_much("amk_metka",1)
end		
function doktor_biznes1_have()
	if doktor_biznes1_have_all() then
		db.actor:give_info_portion("doktor_biznes1_have")
		return true
	else
		return false
	end
end
function doktor_biznes1_done()
		sak.out_item_namber("medkit",20)
		sak.out_item_namber("medkit_army",30)
		sak.out_item_namber("medkit_scientic",40)
		sak.out_item_namber("bandage",100)
		sak.out_item_namber("antirad",50)
		sak.out_item_namber("antizombie",10)
		sak.out_item_namber("vodka",20)
		sak.out_item_namber("af_life_heart",5)
		sak.out_item_namber("maz",15)

		db.actor:give_info_portion("biznes_remove_special_item")
		sak.out_item_namber("amk_metka",1)
		sak.out_item_namber("matras",10)
		sak.out_item_namber("zamok",10)
		sak.out_item_namber("treasure_item",10)
		db.actor:disable_info_portion("biznes_remove_special_item")

	this.give_ammo(10)
	sak.create_items_actor("wpn_m_134",1)
	sak.create_items_actor("cube_chip",1)
end


function borov_biznes1_have_all()
  return
    amk_utils.good_items_have_number({
      [ "wpn_mp5sd" ] =  2,
      [ "wpn_mp5"   ] = 10,
    })
    and new_dialog.item_much( "ammo_9x19_pbp", 50 )
    and new_dialog.item_much( "medkit", 20 )
    and new_dialog.item_much( "bandage", 30 )
    and new_dialog.item_much( "bread", 20 )
    and new_dialog.item_much( "kolbasa", 10 )
    and new_dialog.item_much( "conserva", 10 )
    and new_dialog.item_much( "af_medusa", 2 )
    and new_dialog.item_much( "af_gravi", 3 )
    and new_dialog.item_much( "af_drops", 3 )
    and new_dialog.item_much( "af_blood", 5 )
    and new_dialog.item_much( "af_fuzz_kolobok", 2 )
    and new_dialog.item_much( "af_soul", 1 )
    and new_dialog.item_much( "af_cry_1", 2 )
end


function borov_biznes1_have()
	if borov_biznes1_have_all() then
		db.actor:give_info_portion("borov_biznes1_have")
		return true
	else
		return false
	end
end


function borov_biznes1_done()
  amk_utils.out_good_items_number({
    [ "wpn_mp5sd" ] =  2,
    [ "wpn_mp5"   ] = 10,
  })
  sak.out_item_namber( "ammo_9x19_pbp", 50 )
  sak.out_item_namber( "medkit", 20 )
  sak.out_item_namber( "bandage", 30 )
  sak.out_item_namber( "bread", 20 )
  sak.out_item_namber( "kolbasa", 10 )
  sak.out_item_namber( "conserva", 10 )
  sak.out_item_namber( "af_medusa", 2 )
  sak.out_item_namber( "af_gravi", 3 )
  sak.out_item_namber( "af_drops", 3 )
  sak.out_item_namber( "af_blood", 5 )
  sak.out_item_namber( "af_fuzz_kolobok", 2 )
  sak.out_item_namber( "af_soul", 1 )
  sak.out_item_namber( "af_cry_1", 2 )
  this.give_ammo( 10 )
  sak.create_items_actor( "wpn_m_134", 1 )
  sak.create_items_actor( "cube_chip", 1 )
end


function doktor_lekar1_have()
	if not has_alife_info("doktor_lekar1_start") or has_alife_info("acv_lekar2") then return end

	local cnt = amk.load_variable("lekar",0)
	cnt = cnt+1
	
	if cnt == 1 then
		news_manager.send_tip(db.actor, "%c[255,160,160,160]".."ДОКТОР:".."\\n".."%c[255,255,128,128]Да, Меченый, именно так и нужно лечить людей - отдавая им аптечку. Носи всегда с собой запасные аптечки, чтобы ты мог помочь не только себе.".."".."\n", nil, nil, 30000)
		-- Звуковое сопровождение
		local snd_obj = xr_sound.get_safe_sound_object([[device\pda\pda_tip]])
		snd_obj:play_no_feedback(db.actor, sound_object.s2d, 0, vector(), 1.0)
	elseif cnt == 4 then
		news_manager.send_tip(db.actor, "%c[255,160,160,160]".."ДОКТОР:".."\\n".."%c[255,255,128,128]Молодец, Меченый! Приятно видеть, что в Зоне есть добрые люди!".."".."\n", nil, nil, 30000)
		-- Звуковое сопровождение
		local snd_obj = xr_sound.get_safe_sound_object([[device\pda\pda_tip]])
		snd_obj:play_no_feedback(db.actor, sound_object.s2d, 0, vector(), 1.0)
	elseif cnt == 7 then
		news_manager.send_tip(db.actor, "%c[255,160,160,160]".."ДОКТОР:".."\\n".."%c[255,255,128,128]Продолжай в том же духе, друг мой!".."".."\n", nil, nil, 30000)
		-- Звуковое сопровождение
		local snd_obj = xr_sound.get_safe_sound_object([[device\pda\pda_tip]])
		snd_obj:play_no_feedback(db.actor, sound_object.s2d, 0, vector(), 1.0)
	elseif cnt == 10 then
		news_manager.send_tip(db.actor, "%c[255,160,160,160]".."ДОКТОР:".."\\n".."%c[255,255,128,128]Меченый, ты справился с моим поручением и показал, что на тебя можно положиться. Жду тебя в гости, есть кое-что интересное.".."".."\n", nil, nil, 30000)
		-- Звуковое сопровождение
		local snd_obj = xr_sound.get_safe_sound_object([[device\pda\pda_tip]])
		snd_obj:play_no_feedback(db.actor, sound_object.s2d, 0, vector(), 1.0)
		db.actor:give_info_portion("doktor_lekar1_have")
	elseif cnt == 20 then
		db.actor:give_info_portion("acv_lekar")
	elseif cnt == 30 then
		db.actor:give_info_portion("acv_lekar2")
		amk.del_variable("lekar")
		return
	end
	
	amk.save_variable("lekar",cnt)
end

function doktor_lekar1_money()
	if has_alife_info("acv_lekar2") then
		aem_manager.manage_money(math.random(1000,2000), "in")
	end
end

-- Убийство контролеров в онлайне, чтобы не было зацикливания пения
function kill_online_kontroller()
	local result = false
	for id,obj in pairs(db.creatures) do
		if obj and obj:clsid() == clsid.controller_s and obj:alive() then
			obj:kill(obj)
			result = true
		end
	end
	return result
end

function checking_taken_item62(obj)
  local obj_sect = obj:section()
  if obj_sect=="strelok_taynik_pda1" then
	if has_alife_info("strelok_taynik_pda1_found") then 
	  if not has_alife_info("strelok_taynik_stop") then 
	    db.actor:give_info_portion("strelok_taynik_pda1_have")
	    if not has_alife_info("strelok_taynik_pda1_xvatit_spawn") then 
		  local se_obj = alife():create("s_inventory_box1_2",vector():set(176.28475952148,17.963838577271,40.265209197998),256932,2145)
		  se_obj = dsh.create_free_monster("m_controller_normal",vector():set(87.854019165039,-2.5235424041748,86.012077331543),199525,2143) 
		  se_obj = dsh.create_free_monster("m_controller_normal_fat",vector():set(87.854019165039,-2.5235424041748,86.012077331543),199525,2143) 
		  se_obj = dsh.create_free_monster("m_controller_old",vector():set(160.51348876953,-2.2140634059906,89.546524047852),249284,2177)		
		  se_obj = dsh.create_free_monster("m_controller_old_fat",vector():set(160.51348876953,-2.2140634059906,89.546524047852),249284,2177)		
		  xr_effects.play_zvuk3()
		  db.actor:give_info_portion("strelok_taynik_pda1_xvatit_spawn")
		end
	  end
	else
	  db.actor:give_info_portion("strelok_taynik_stop")
	end
  elseif obj_sect=="strelok_taynik_pda1_2" then
    if not has_alife_info("strelok_taynik_pda1_done") then 
      news_manager.send_tip(db.actor, "%c[255,160,160,160]".."СТРЕЛОК:".."\\n".."%c[255,255,128,128]Ты, наверное, решил, что, найдя мой первый тайник, ты найдёшь тут ещё что-нибудь полезное? Ха-ха-ха! Следующий мой тайник тебе придётся поискать ещё дольше! Единственное, чем я могу помочь тебе, это закинуть тебя обратно на крышу высотки. Для этого пройди по этой крыше дальше до конца.".."\\n".."%c[255,1,255,1]1917-1986. 69 лет Советской власти в Припяти. Ура, товарищи!".."\\n".."%c[255,255,128,128]Гм, о чем это я?".."".."\n", nil, nil, 30000)
	  -- Звуковое сопровождение
	  local snd_obj = xr_sound.get_safe_sound_object([[device\pda\pda_tip]])
      snd_obj:play_no_feedback(db.actor, sound_object.s2d, 0, vector(), 1.0)
	  this.spawn_s_teleport1_2()
	  spawn_restrictor.strelok_taynik_pda1_3_1_sr1()
	end
    amk.drop_item(db.actor,obj)
	amk.remove_item(obj)
  elseif obj_sect=="strelok_taynik_pda1_3" then
    if not has_alife_info("strelok_taynik_pda1_done") then 
      news_manager.send_tip(db.actor, "%c[255,160,160,160]".."СТРЕЛОК:".."\\n".."%c[255,255,128,128]А ты настырный. Мне это нравится. Раз ты такой любопытный, даю тебе ещё одну наводку: есть рюкзачок на автовокзале, но с земли его не достать. Думай, Сталкер, думай!".."".."\n", nil, nil, 30000)
	  -- Звуковое сопровождение
	  local snd_obj = xr_sound.get_safe_sound_object([[device\pda\pda_tip]])
      snd_obj:play_no_feedback(db.actor, sound_object.s2d, 0, vector(), 1.0)
	  spawn_restrictor.strelok_taynik_pda1_3_2_sr1()
	end
    amk.drop_item(db.actor,obj)
	amk.remove_item(obj)
  elseif obj_sect=="strelok_taynik_pda1_4" then
    if not has_alife_info("strelok_taynik_pda1_done") then 
      news_manager.send_tip(db.actor, "%c[255,160,160,160]".."СТРЕЛОК:".."\\n".."%c[255,255,128,128]Нашёл. Молодец. Хочешь попасть обратно на крышу высотки, откуда ты начал? Найди мой рюкзак на шестом этаже. Для этого сначала запрыгни обратно на крышу дома, с которого ты попал сюда.".."".."\n", nil, nil, 30000)
	  -- Звуковое сопровождение
	  local snd_obj = xr_sound.get_safe_sound_object([[device\pda\pda_tip]])
      snd_obj:play_no_feedback(db.actor, sound_object.s2d, 0, vector(), 1.0)
	  this.spawn_s_teleport1_4()
	  spawn_restrictor.strelok_taynik_pda1_4_sr1()
	end
    amk.drop_item(db.actor,obj)
	amk.remove_item(obj)
  elseif obj_sect=="strelok_taynik_pda1_5" then
    if not has_alife_info("strelok_taynik_pda1_done") then 
      news_manager.send_tip(db.actor, "%c[255,160,160,160]".."СТРЕЛОК:".."\\n".."%c[255,255,128,128]Ой, он провалился на пятый этаж! Наверное, очередным выбросом разрушило балкон. А, может, телепорт тоже провалился? Ну-ка, проверь другой край балкона?".."\\n".."И ещё, раз уж ты такой опытный Сталкер, что нашёл все мои тайники в Центральной Припяти, я дам тебе подсказку: мой тайник с артефактами ты найдёшь вместе с одним из тайников, о которых тебе расскажет Доктор. Удачи!".."".."\n", nil, nil, 30000)
	  -- Звуковое сопровождение
	  local snd_obj = xr_sound.get_safe_sound_object([[device\pda\pda_tip]])
      snd_obj:play_no_feedback(db.actor, sound_object.s2d, 0, vector(), 1.0)
	  this.delete_teleport("s_teleport1_1")
	  this.delete_teleport("s_teleport1_3_1")
	  this.delete_teleport("s_teleport1_3_2")
	  this.delete_teleport("s_teleport1_4")
	end
    amk.drop_item(db.actor,obj)
	amk.remove_item(obj)
  elseif (obj_sect=="strelok_taynik_pda2_1" and db.actor:object("strelok_taynik_pda2_2") ~= nil) or (obj_sect=="strelok_taynik_pda2_2" and db.actor:object("strelok_taynik_pda2_1") ~= nil) then
	if not has_alife_info("strelok_taynik_stop") then 
	  db.actor:give_info_portion("strelok_taynik_pda2_have")
	end
  elseif obj_sect=="strelok_taynik_pda30" then
    if not has_alife_info("strelok_taynik_stop") then 
	  db.actor:give_info_portion("strelok_taynik_pda30_have")
	end
  elseif obj_sect=="strelok_taynik_pda3" then
	if not has_alife_info("strelok_taynik_stop") then 
	  if not has_alife_info("strelok_taynik_pda3_have") then 
	    local se_obj = alife():create("s_inventory_box3_1",vector():set(-99.41,1.37,-171.46),12046,3241)
	    se_obj = alife():create("s_inventory_box3_2",vector():set(-155.51449584961,-4.6265954971313,-262.34503173828),5644,3238)
	    this.spawn_s_teleport3_2()
	    db.actor:give_info_portion("strelok_taynik_pda3_have")
	  end
	end
  elseif (obj_sect=="strelok_taynik_pda3_1" and db.actor:object("strelok_taynik_pda3_2") ~= nil) or (obj_sect=="strelok_taynik_pda3_2" and db.actor:object("strelok_taynik_pda3_1") ~= nil) then
	if not has_alife_info("strelok_taynik_stop") then 
	  if not has_alife_info("strelok_taynik_pda3_12_have") then 
	    local se_obj = alife():create("s_inventory_box3_3",vector():set(73.26683807373,1.484278678894,241.13470458984),29207,1244)
	    db.actor:give_info_portion("strelok_taynik_pda3_12_have")
	  end
	end
  elseif obj_sect=="strelok_taynik_pda3_3" then
    if not has_alife_info("strelok_taynik_stop") then 
      if not has_alife_info("strelok_taynik_pda3_3_have") then 
	    this.strelok_taynik_pda3_drop()
	    db.actor:give_info_portion("strelok_taynik_pda3_3_have")
	  end
	end
  elseif obj_sect=="strelok_taynik_pda4" then
	if has_alife_info("strelok_taynik_pda4_found") then 
	  if not has_alife_info("strelok_taynik_stop") then 
	    if not has_alife_info("strelok_taynik_pda4_have") then 
		  this.delete_s_teleport4_1()
	      db.actor:give_info_portion("strelok_taynik_pda4_have")
		end
	  end
	else
	  db.actor:give_info_portion("strelok_taynik_stop")
	end
  elseif obj_sect=="strelok_taynik_pda5" then
    if not has_alife_info("strelok_taynik_stop") then 
	  db.actor:give_info_portion("strelok_taynik_pda5_have")
	end
  elseif obj_sect=="strelok_taynik_pda6" then
    if not has_alife_info("strelok_taynik_stop") then 
	  db.actor:give_info_portion("strelok_taynik_pda6_have")
	  if not has_alife_info("strelok_taynik_pda6_xvatit_spawn") then 
	    local se_obj = dsh.create_free_monster("bloodsucker_strong",vector():set(-194.36819458008,49.02271270752,-535.56390380859),112200,3082)
	    se_obj = dsh.create_free_monster("bloodsucker_normal",vector():set(-189.69694519043,47.406341552734,-548.29016113281),117716,3082)
	    se_obj = dsh.create_free_monster("bloodsucker_normal",vector():set(-174.30001831055,49.662406921387,-521.21356201172),135088,3089)
	    se_obj = dsh.create_free_monster("bloodsucker_normal",vector():set(-170.43768310547,46.646286010742,-550.90631103516),139967,3088)
	    xr_effects.play_zvuk3()
		db.actor:give_info_portion("strelok_taynik_pda6_xvatit_spawn")
	  end
	end
  elseif obj_sect=="strelok_taynik_pda7" then
    if has_alife_info("strelok_taynik_pda7_found") then 
 	  if not has_alife_info("strelok_taynik_stop") then 
	    news_manager.send_tip(db.actor, "%c[255,160,160,160]".."СТРЕЛОК:".."\\n".."%c[255,255,128,128]Уважаемый "..user_name().."! Когда я прятал этот тайник, я совершенно не знал, какую награду сюда можно положить для того, кто найдёт его... Я уверен, что к этому моменту у тебя, "..user_name()..", уже все есть. Ты - Терминатор с самым крутым оружием, имеешь все необходимые артефакты и полную защиту от всех возможных угроз. Ты ленишься наклониться даже за гауссом, не говоря уже об обычных артефактах. Поэтому я оставил тайник пустым. Надеюсь, ты не обиделся...".."\\n".."PS: Кстати, "..user_name()..", а ты уже нашёл мой последний тайник с артефактами? Если нет - то загрузись с сейва перед прыжком сюда и найди сначала его! Он где-то здесь, на антеннах!".."".."\n", nil, nil, 50000)
	    db.actor:give_info_portion("strelok_taynik_pda7_done")
	  end
	else
	  db.actor:give_info_portion("strelok_taynik_stop")
	end
    if has_alife_info("strelok_taynik_pda0_done") then 
	  this.delete_s_teleport0_1()
	end
	amk.drop_item(db.actor,obj)
	amk.remove_item(obj)
  elseif obj_sect=="strelok_taynik_pda0" then
 	if not has_alife_info("strelok_taynik_stop") then 
      news_manager.send_tip(db.actor, "%c[255,160,160,160]".."СТРЕЛОК:".."\\n".."%c[255,255,128,128]Ну, "..user_name()..", раз ты нашёл этот мой тайник, то все эти призы твои. А чтоб снова не лезть на антенну, спрыгни в дыру на крыше.".."".."\n", nil, nil, 30000)
	  -- Звуковое сопровождение
	  local snd_obj = xr_sound.get_safe_sound_object([[device\pda\pda_tip]])
      snd_obj:play_no_feedback(db.actor, sound_object.s2d, 0, vector(), 1.0)
	  
  	  this.spawn_s_teleport0_1()
  	  db.actor:give_info_portion("strelok_taynik_pda0_done")
	  alife():create("amk_kanistra",vector():set(30.90,7.33,-39.75),210337,1045)
	  spawn_restrictor.stdt1_sr1()
	end
    amk.drop_item(db.actor,obj)
	amk.remove_item(obj)
  elseif obj_sect=="stdt_pda1" then 
    news_manager.send_tip(db.actor, "%c[255,160,160,160]".."СТРЕЛОК:".."\\n".."%c[255,255,128,128]Все, "..user_name().."! Теперь уже точно все! Это было последнее, что я для тебя приготовил. Удачи!".."".."\n", nil, nil, 30000)
	-- Звуковое сопровождение
	local snd_obj = xr_sound.get_safe_sound_object([[device\pda\pda_tip]])
    snd_obj:play_no_feedback(db.actor, sound_object.s2d, 0, vector(), 1.0)
	
	local se_obj = db.actor:object("stdt_pda1")
	amk.drop_item(db.actor,se_obj)
	amk.remove_item(se_obj)
  end
end

function s_inventory_box1()
  local obj = alife():create("s_inventory_box1",vector():set(126.61811828613,15.248512268066,90.880737304688),225170,2143)
  this.create_teleport("s_teleport1_1",vector():set(122.58910369873,4.5209398269653,87.757598876953),229491,2143)
  spawn_restrictor.strelok_taynik_pda1_sr1()
end

function s_inventory_box2()
  taynik_spawn.s_new_inventory2_1()
  local obj = alife():create("s_inventory_box2_2",vector():set(-77.04369354248,-7.4020524024963,-20.482629776001),90914,892)
end

function s_inventory_box30()
  local obj = alife():create("s_inventory_box30",vector():set(73.863845825195,-0.0094784200191498,121.16677093506),29686,1221)
end

function s_inventory_box3()
  local obj = alife():create("s_inventory_box3",vector():set(16.393283843994,37.914726257324,2.0604181289673),6342,2453)
end

function s_inventory_box4()
  local obj = alife():create("s_inventory_box4",vector():set(596.83740234375,-49.984550476074,-24.092365264893),214270,1899)
  this.spawn_s_teleport4_1()
  spawn_restrictor.strelok_taynik_pda4_sr1()
  obj = alife():create("af_dummy_spring_red",vector():set(664.32122802734,-44.515979766846,-37.01086807251),227163,1896)
  obj = alife():create("af_dummy_battery_red",vector():set(664.32122802734,-44.515979766846,-37.01086807251),227163,1896)
  obj = alife():create("af_dummy_pellicle_red",vector():set(664.32122802734,-44.515979766846,-37.01086807251),227163,1896)
end

function s_inventory_box5()
  local obj = alife():create("s_inventory_box5",vector():set(984.81433105469,11.019639015198,245.36875915527),261708,2646)
end

function s_inventory_box6()
  spawn_restrictor.strelok_taynik_pda6_sr1()
  spawn_restrictor.strelok_taynik_pda6_sr2()
  spawn_restrictor.strelok_taynik_pda6_sr3()
end

function s_inventory_box7()
  local obj = alife():create("s_inventory_box7",vector():set(-17.708236694336,17.989824295044,-4.267804145813),5646,2026)
  spawn_restrictor.strelok_taynik_pda7_sr1()
  spawn_restrictor.strelok_taynik_pda7_sr2()
end

function strelok_taynik_pda1_have(task, objective)
  if db.actor ~= nil then
    if has_alife_info("strelok_taynik_pda1_found") then 
      return db.actor:object("strelok_taynik_pda1") ~= nil
	end
  end
  return false
end
function strelok_taynik_pda1_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "strelok_taynik_pda1", "out")
  this.delete_s_teleport1_2()
end

function strelok_taynik_pda2_have(task, objective)
  if db.actor ~= nil then
    return db.actor:object("strelok_taynik_pda2_1") ~= nil and db.actor:object("strelok_taynik_pda2_2") ~= nil
  end
  return false
end
function strelok_taynik_pda2_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "strelok_taynik_pda2_1", "out")
  dialogs.relocate_item_section(second_speaker, "strelok_taynik_pda2_2", "out")
end

function strelok_taynik_pda30_have(task, objective)
  if db.actor ~= nil then
    return db.actor:object("strelok_taynik_pda30") ~= nil
  end
  return false
end
function strelok_taynik_pda30_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "strelok_taynik_pda30", "out")
end

function strelok_taynik_pda3_have(task, objective)
  if db.actor ~= nil then
    return db.actor:object("strelok_taynik_pda3") ~= nil
  end
  return false
end
function strelok_taynik_pda3_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "strelok_taynik_pda3", "out")
end
function strelok_taynik_pda3_drop()
    this.delete_s_teleport3_2()
	local se_obj = db.actor:object("strelok_taynik_pda3_1")
	amk.drop_item(db.actor,se_obj)
	amk.remove_item(se_obj)
	se_obj = db.actor:object("strelok_taynik_pda3_2")
	amk.drop_item(db.actor,se_obj)
	amk.remove_item(se_obj)
	se_obj = db.actor:object("strelok_taynik_pda3_3")
	amk.drop_item(db.actor,se_obj)
	amk.remove_item(se_obj)
end

function strelok_taynik_pda4_have(task, objective)
  if db.actor ~= nil then
    if has_alife_info("strelok_taynik_pda4_found") then 
      return db.actor:object("strelok_taynik_pda4") ~= nil
	end
  end
  return false
end
function strelok_taynik_pda4_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "strelok_taynik_pda4", "out")
end

function strelok_taynik_pda5_have(task, objective)
  if db.actor ~= nil then
    return db.actor:object("strelok_taynik_pda5") ~= nil
  end
  return false
end
function strelok_taynik_pda5_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "strelok_taynik_pda5", "out")
end

function strelok_taynik_pda6_have(task, objective)
  if db.actor ~= nil then
    if has_alife_info("strelok_taynik_pda6_found") then 
      return db.actor:object("strelok_taynik_pda6") ~= nil
	end
  end
  return false
end
function strelok_taynik_pda6_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "strelok_taynik_pda6", "out")
end

function strelok_taynik_pda7_have(task, objective)
  if db.actor ~= nil then
    if has_alife_info("strelok_taynik_pda7_found") then 
      return db.actor:object("strelok_taynik_pda7") ~= nil
	end
  end
  return false
end

function spawn_s_teleport1_2()
    local se_obj = alife():create("s_teleport1_2",vector():set(207.23626708984,17.963800430298,48.94217300415),260660,2145)
	xr_logic.pstor_store(db.actor, "s_teleport1_2", se_obj.id)		  
end
function delete_s_teleport1_2(story_id)
	local obj_id = xr_logic.pstor_retrieve(db.actor, "s_teleport1_2", -1, true)
	local se_obj = alife() : object(obj_id)
if se_obj then
  alife():release(se_obj, true)
end
end
function spawn_s_teleport1_3_1()
    local se_obj = alife():create("s_teleport1_3_1",vector():set(98.162727355957,28.547431945801,38.083969116211),225595,2143)
	xr_logic.pstor_store(db.actor, "s_teleport1_3_1", se_obj.id)		  
end
function spawn_s_teleport1_3_2()
    local se_obj = alife():create("s_teleport1_3_2",vector():set(-17.820304870605,13.85008430481,11.088830947876),81517,2160)
	xr_logic.pstor_store(db.actor, "s_teleport1_3_2", se_obj.id)		  
end
function spawn_s_teleport1_4()
    local se_obj = alife():create("s_teleport1_4",vector():set(-90.959411621094,13.623492240906,28.934303283691),7528,2253)
	xr_logic.pstor_store(db.actor, "s_teleport1_4", se_obj.id)		  
end
function spawn_s_teleport1_5()
    local se_obj = alife():create("s_teleport1_5",vector():set(43.850486755371,11.828426361084,37.138198852539),155631,2225)
	xr_logic.pstor_store(db.actor, "s_teleport1_5", se_obj.id)		  
end

function spawn_s_teleport3_2()
    local se_obj = alife():create("s_teleport3_2",vector():set(-150.38586425781,-5.7839937210083,-278.90524291992),6896,3238)
	xr_logic.pstor_store(db.actor, "s_teleport3_2", se_obj.id)		  
end
function delete_s_teleport3_2(story_id)
	local obj_id = xr_logic.pstor_retrieve(db.actor, "s_teleport3_2", -1, true)
	local se_obj = alife() : object(obj_id)
if se_obj then
  alife():release(se_obj, true)
end
end

function spawn_s_teleport4_1()
    local se_obj = alife():create("s_teleport4_1",vector():set(308.16702270508,-37.625602722168,-21.087753295898),69058,1930)
	xr_logic.pstor_store(db.actor, "s_teleport4_1", se_obj.id)		  
end
function delete_s_teleport4_1(story_id)
	local obj_id = xr_logic.pstor_retrieve(db.actor, "s_teleport4_1", -1, true)
	local se_obj = alife() : object(obj_id)
if se_obj then
  alife():release(se_obj, true)
end
end

function spawn_s_teleport0_1()
    local se_obj = alife():create("s_teleport0_1",vector():set(-1.5840334892273,5.1518805027008,-44.498065948486),10089,1961)
	xr_logic.pstor_store(db.actor, "s_teleport0_1", se_obj.id)		  
end
function delete_s_teleport0_1(story_id)
	local obj_id = xr_logic.pstor_retrieve(db.actor, "s_teleport0_1", -1, true)
	local se_obj = alife() : object(obj_id)
if se_obj then
  alife():release(se_obj, true)
end
end

function checking_taken_item59(obj)
  local obj_sect = obj:section()
  if string.find(obj_sect,"kostya_taynik_pda1_") then
	db.actor:give_info_portion("kostya_taynik_pda_have_1_"..string.sub(obj_sect,string.find(obj_sect,"1_")+2))
	if not has_alife_info("kostya_taynik_pda1_tele") then 
	  news_manager.send_tip(db.actor, "На полях пометка: Чтобы не забыть - телепорт находится в комнате над гастрономом, в которую нельзя попасть по основной лестнице.", nil, nil, 30000)
	  this.spawn_t_teleport1_1()
	  db.actor:give_info_portion("kostya_taynik_pda1_tele")
	end
	if obj_sect=="kostya_taynik_pda1_2" then 
	  if not has_alife_info("kostya_taynik_pda1_2_xvatit_spawn") then 
	    news_manager.send_tip(db.actor, "Внизу примечание: Тайник на первом этаже - в одном из соседних домов.", nil, nil, 30000)
	    db.actor:give_info_portion("kostya_taynik_pda1_2_xvatit_spawn")
	  end
	end
    if has_alife_info("kostya_taynik_pda_have_1_1") and has_alife_info("kostya_taynik_pda_have_1_2") and has_alife_info("kostya_taynik_pda_have_1_3") and has_alife_info("kostya_taynik_pda_have_1_4") and has_alife_info("kostya_taynik_pda_have_1_5") then
	  if not has_alife_info("kostya_taynik_pda1_have") then 
	    this.delete_t_teleport1_1()
	    this.spawn_t_teleport1_2()
	    news_manager.send_tip(db.actor, "В углу надпись: Телепорт на крышу - на разрушенной лестнице в кинотеатре.", nil, nil, 30000)
        db.actor:give_info_portion("kostya_taynik_pda1_have")
	  end
	end
  elseif obj_sect=="kostya_taynik_pda4" then 
	if not has_alife_info("kostya_taynik_pda4_xvatit_spawn") then 
	  news_manager.send_tip(db.actor, "%c[255,160,160,160]".."СТАРЫЙ ЖИЛ:".."\\n".."%c[255,255,128,128]Чтоб меньше бегать от пещеры к заимке, сделал телепорт возле одного из входов. Нужно прыгнуть с камня в аномалию.".."".."\n", nil, nil, 30000)
	  -- Звуковое сопровождение
	  local snd_obj = xr_sound.get_safe_sound_object([[device\pda\pda_tip]])
      snd_obj:play_no_feedback(db.actor, sound_object.s2d, 0, vector(), 1.0)

	  this.spawn_t_teleport4_1()
	  local se_obj = dsh.create_free_monster("m_controller_normal",vector():set(293.54354858398,-6.1697669029236,-306.34655761719),1388412,2903) 
	  se_obj = dsh.create_free_monster("m_controller_normal",vector():set(293.54354858398,-6.1697669029236,-306.34655761719),1388412,2903) 
	  se_obj = dsh.create_free_monster("m_controller_old_fat",vector():set(343.52505493164,-1.7487429380417,-291.03280639648),1481127,2903)		
	  se_obj = dsh.create_free_monster("m_controller_normal_fat",vector():set(343.52505493164,-1.7487429380417,-291.03280639648),1481127,2903)		
	  db.actor:give_info_portion("kostya_taynik_pda4_xvatit_spawn")
	end
  elseif obj_sect=="kostya_taynik_pda8" then 
	if not has_alife_info("kostya_taynik_pda8_xvatit_spawn") then 
	  local se_obj = dsh.create_free_monster("m_controller_normal",vector():set(-245.26629638672,-0.0019612908363342,108.61695098877),11654,1358) 
	  se_obj = dsh.create_free_monster("m_controller_old_fat",vector():set(-268.68731689453,-0.0014384984970093,67.68074798584),4443,1410) 
	  se_obj = dsh.create_free_monster("m_controller_old",vector():set(-208.81796264648,-0.00040912628173828,164.56384277344),25007,1332)		
	  db.actor:give_info_portion("kostya_taynik_pda8_xvatit_spawn")
	end
  elseif obj_sect=="ktdt_pda1" then 
	if has_alife_info("ktdt1_found") then 
      db.actor:give_info_portion("ktdt2")
      news_manager.send_tip(db.actor, "Найдена информация.", nil, nil, 20000)
	  local se_obj = alife():create("x_inventory_box2",vector():set(-0.79496783018112,1.145513176918,10.266807556152),309442,1582)
      this.spawn_x_teleport2()
	  this.delete_teleport("x_teleport1")
	  se_obj = db.actor:object("ktdt_pda1")
	  amk.drop_item(db.actor,se_obj)
	  amk.remove_item(se_obj)
	end
  elseif obj_sect=="ktdt_pda2" then 
	if has_alife_info("ktdt2_found") then
      aem_manager.manage_money(1000000, "in")
      db.actor:give_info_portion("ktdt3")
      news_manager.send_tip(db.actor, "Найдена информация.", nil, nil, 20000)
      this.spawn_x_teleport3()
	  local se_obj = db.actor:object("ktdt_pda2")
	  amk.drop_item(db.actor,se_obj)
	  amk.remove_item(se_obj)
	end
  elseif obj_sect=="ktdt_pda3" then 
	if has_alife_info("ktdt3_found") then
      news_manager.send_tip(db.actor, "%c[255,160,160,160]".."СТАРЫЙ ЖИЛ:".."\\n".."%c[255,255,128,128]Ну, "..user_name()..", вот ты и нашёл все мои тайники! Поздравляю!".."".."\n", nil, nil, 30000)
	  local se_obj = db.actor:object("ktdt_pda3")
	  amk.drop_item(db.actor,se_obj)
	  amk.remove_item(se_obj)
	end
  end
end

function t_inventory_box1()
  spawn_restrictor.kostya_taynik_pda1_sr1()
end
function kostya_taynik_pda1_have(task, objective)
    return has_alife_info("kostya_taynik_pda1_have")
end
function kostya_taynik_pda1_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda1_1", "out")
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda1_2", "out")
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda1_3", "out")
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda1_4", "out")
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda1_5", "out")
end

function t_inventory_box21()
  taynik_spawn.t_new_inventory21()
end
function kostya_taynik_pda21_have(task, objective)
	if new_dialog.item_much("kostya_taynik_pda21",18) then
		db.actor:give_info_portion("kostya_taynik_pda21_have")
		return true
	else
		return false
	end
end
function kostya_taynik_pda21_done(task, objective)
	sak.out_item_namber("kostya_taynik_pda21",18)

	-- спавним порталы и переходы
	local obj, params
	local portals = {
		{eh={x=-95.833763122559,y=-20.12349319458,z=73.946479797363,gv=3838,lv=1098},
		 lc={x=-94.074142456055,y=-18.931434631348,z=73.887977600098,gv=3838,lv=1289},
		 to={x=-5.1342377662659,y=-8.7591800689697,z=-43.163402557373,gv=2694,lv=5035},
		 dir={x=0,y=-1.57,z=0},
		 level="labx8"
		},
		{eh={x=0.057874165475369,y=-9.2725133895874,z=-43.226726531982,gv=2694,lv=5869},
		 lc={x=1.7423397302628,y=-8.0805139541626,z=-43.251842498779,gv=2694,lv=6289},
		 to={x=96.647491455078,y=5.50750207901,z=-15.555990219116,gv=1539,lv=6547},
		 dir={x=0,y=-1.57,z=0},
		 level="l10u_bunker"
		},
		{eh={x=102.00410461426,y=5.56742811203,z=-15.614800453186,gv=1544,lv=6771},
		 lc={x=103.65747070313,y=6.7574377059937,z=-15.629001617432,gv=1544,lv=6820},
		 to={x=8.3273286819458,y=-12.429878234863,z=23.948041915894,gv=1155,lv=3980},
		 dir={x=0,y=-1.57,z=0},
		 level="l08u_brainlab"
		},
		{eh={x=13.632986068726,y=-12.430124282837,z=23.89408493042,gv=1155,lv=4797},
		 lc={x=15.552788734436,y=-11.238062858582,z=23.86653137207,gv=1155,lv=5156},
		 to={x=-87.99201965332,y=-20.119352340698,z=73.813842773438,gv=3838,lv=1899},
		 dir={x=0,y=1.57,z=0},
		 level="l04u_labx18"
		}
	}
	
	for i,a in pairs(portals) do
 		obj = alife():create("event_horisont",vector():set(a.eh.x,a.eh.y,a.eh.z),a.eh.lv,a.eh.gv)
		params = amk.get_destroyable_data(obj)
		params.oflags = -198		-- 0xffffff3a object_flags
		params.vsu8u1 = 1			-- 0x1 visual_flags
		params.skeleton = "idle"
		params.skeleton_flags = 1
		params.physic_type = 3		-- 0x3
		params.mass = 100
		params.fixed_bones = "joint1"
		amk.set_destroyable_data(params,obj)
		alife():create("zone_event_horisont",vector():set(a.eh.x,a.eh.y+1.7,a.eh.z),a.eh.lv,a.eh.gv)

		create_eh_lc(220000+i, vector():set(a.lc.x,a.lc.y,a.lc.z),a.lc.lv,a.lc.gv,
			vector():set(a.to.x,a.to.y,a.to.z),a.to.lv,a.to.gv,
			vector():set(a.dir.x,a.dir.y,a.dir.z),
			a.level,
			0)
	end
end

function create_eh_lc(
	p_story_id,	-- STORY_ID нового level_changer (понадобится нам позже)
	
	p_position,	-- вектор, координаты точки, в которой будет располагаться центр нового level_changer
	p_lvertex_id,	-- level_vertext_id  - идентифицируют уровень, на котором будет создан level_changer
	p_gvertex_id,	-- game_vertext_id   	
 
	p_dest_pos,	-- координаты точки, в которой на новом уровне окажется игрок
	p_dest_lv,	-- level_vertex_id   - идентифицируют уровень, на который level_changer будет перебрасывать игрока 
	p_dest_gv,	-- game_vertex_id
	p_dest_dir,	-- направрение взгляда игрока
	p_dest_level,	-- название уровня, например "L11_Pripyat"
	p_silent	-- следует задать 1, чтобы подавить вопрос о смене уровня (автоматический переход)
)
	local sim = alife()
	local obj = sim:create("level_changer", p_position, p_lvertex_id, p_gvertex_id)
 
	local packet = net_packet()
	obj:STATE_Write(packet)
 
	-- свойства cse_alife_object
	local game_vertex_id 			= packet:r_u16()
	local cse_alife_object__unk1_f32 	= packet:r_float()
	local cse_alife_object__unk2_u32 	= packet:r_u32()
	local level_vertex_id 			= packet:r_u32()
	local object_flags 			= packet:r_u32()
	local custom_data 			= packet:r_stringZ()
	local story_id 				= packet:r_u32()
	local spawn_story_id			= packet:r_u32()
 
	-- свойства cse_shape
	local shape_count 			= packet:r_u8()
	for i=1,shape_count do
		local shape_type 		= packet:r_u8()
		if shape_type == 0 then
			-- sphere
			local center 		= packet:r_vec3()
			local radius 		= packet:r_float()
		else
			-- box
			local axis_x_x = packet:r_float()
			local axis_x_y = packet:r_float()
			local axis_x_z = packet:r_float()
			local axis_y_x = packet:r_float()
			local axis_y_y = packet:r_float()
			local axis_y_z = packet:r_float()
			local axis_z_x = packet:r_float()
			local axis_z_y = packet:r_float()
			local axis_z_z = packet:r_float()
			local offset_x = packet:r_float()
			local offset_y = packet:r_float()
			local offset_z = packet:r_float()
		end
	end
 
	-- свойства cse_alife_space_restrictor
	local restrictor_type 			= packet:r_u8()
 
	-- свойства cse_level_changer
	local dest_game_vertex_id		= packet:r_u16()  
	local dest_level_vertex_id 		= packet:r_u32()  
	local dest_position 			= packet:r_vec3()
	local dest_direction 			= packet:r_vec3()
	local dest_level_name 			= packet:r_stringZ()
	local dest_graph_point 			= packet:r_stringZ()
	local silent_mode 			= packet:r_u8()
 
 
	packet:w_begin(game_vertex_id)			-- game_vertex_id
	packet:w_float(cse_alife_object__unk1_f32)
	packet:w_u32(cse_alife_object__unk2_u32) 
	packet:w_u32(level_vertex_id)			-- level_vertex_id
	packet:w_u32( bit_not(193) )			-- object_flags = -193 = 0xFFFFFF3E
	packet:w_stringZ(custom_data)
	packet:w_u32(p_story_id)			-- story_id
	packet:w_u32(spawn_story_id)
 
	packet:w_u8(1)			-- количество фигур
		packet:w_u8(0)			-- тип фигуры: сфера
		packet:w_vec3(vector():set(0, 0, 0))  -- sphere_center
		packet:w_float(0.5)
--[[
	packet:w_u8(1)			-- тип фигуры: box
	packet:w_float(2)	   -- axis_x_x
	packet:w_float(0)	   -- axis_x_y
	packet:w_float(0)	   -- axis_x_z
	packet:w_float(0)	   -- axis_y_x
	packet:w_float(4)	   -- axis_y_y
	packet:w_float(0)	   -- axis_y_z
	packet:w_float(0)	   -- axis_z_x
	packet:w_float(0)	   -- axis_z_y
	packet:w_float(4)	   -- axis_z_z
	packet:w_float(0)	   -- offset_x
	packet:w_float(0)	   -- offset_y
	packet:w_float(0)          -- offset_z
]]
	packet:w_u8(3)	 	   -- restrictor_type
 
	packet:w_u16(p_dest_gv)			-- destination game_vertex_id
	packet:w_s32(p_dest_lv)			-- destination level_vertex_id
	packet:w_vec3(p_dest_pos)		-- destination position
	packet:w_vec3(p_dest_dir)		-- destination direction (направление взгляда)
	packet:w_stringZ(p_dest_level)		-- destination level name
	packet:w_stringZ("start_actor_02")	-- some string, always const
	packet:w_u8(p_silent)			-- 1 for silent level changing
 
	packet:r_seek(0)
	obj:STATE_Read(packet, packet:w_tell())
end

function t_inventory_box2()
  taynik_spawn.t_new_inventory2()
end
function kostya_taynik_pda2_have(task, objective)
	if db.actor:object("kostya_taynik_pda2") ~= nil then
		db.actor:give_info_portion("kostya_taynik_pda2_have")
		return true
	else
		return false
	end
end
function kostya_taynik_pda2_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda2", "out")
end

function t_inventory_box3()
  taynik_spawn.t_new_inventory3_1()
  taynik_spawn.t_new_inventory3_2()
  local obj = alife():create("t_inventory_box3_3",vector():set(4.5460352897644,31.063150405884,67.978546142578),27143,2659)
  obj = alife():create("t_inventory_box3_4",vector():set(242.60501098633,73.895149230957,138.61387634277),76288,2573)
end
function kostya_taynik_pda3_have(task, objective)
	if db.actor:object("kostya_taynik_pda3_1") ~= nil and db.actor:object("kostya_taynik_pda3_2") ~= nil and db.actor:object("kostya_taynik_pda3_3") ~= nil and db.actor:object("kostya_taynik_pda3_4") ~= nil then
		db.actor:give_info_portion("kostya_taynik_pda3_have")
		return true
	else
		return false
	end
end
function kostya_taynik_pda3_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda3_1", "out")
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda3_2", "out")
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda3_3", "out")
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda3_4", "out")
end

function t_inventory_box4()
  local obj = alife():create("t_inventory_box4",vector():set(316.57379150391,-12.273648262024,-261.89810180664),1431070,2903)
end
function kostya_taynik_pda4_have(task, objective)
	if db.actor:object("kostya_taynik_pda4") ~= nil then
		db.actor:give_info_portion("kostya_taynik_pda4_have")
		return true
	else
		return false
	end
end
function kostya_taynik_pda4_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda4", "out")
end

function t_inventory_box5()
  taynik_spawn.t_new_inventory5()
end
function kostya_taynik_pda5_have(task, objective)
	if db.actor:object("kostya_taynik_pda5") ~= nil then
		db.actor:give_info_portion("kostya_taynik_pda5_have")
		return true
	else
		return false
	end
end
function kostya_taynik_pda5_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda5", "out")
end

function t_inventory_box6()
  taynik_spawn.t_new_inventory6_1()
  taynik_spawn.t_new_inventory6_2()
end
function kostya_taynik_pda6_have(task, objective)
	if db.actor:object("kostya_taynik_pda6_1") ~= nil and db.actor:object("kostya_taynik_pda6_2") ~= nil then
		db.actor:give_info_portion("kostya_taynik_pda6_have")
		return true
	else
		return false
	end
end
function kostya_taynik_pda6_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda6_1", "out")
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda6_2", "out")
end

function t_inventory_box7()
  local obj = alife():create("t_inventory_box7",vector():set(94.308715820313,14.254689216614,50.491359710693),40199,3336)
end
function kostya_taynik_pda7_have(task, objective)
	if db.actor:object("kostya_taynik_pda7") ~= nil then
		db.actor:give_info_portion("kostya_taynik_pda7_have")
		return true
	else
		return false
	end
end
function kostya_taynik_pda7_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda7", "out")
end

function t_inventory_box8()
  taynik_spawn.t_new_inventory8()
end
function kostya_taynik_pda8_have(task, objective)
	if db.actor:object("kostya_taynik_pda8") ~= nil then
		db.actor:give_info_portion("kostya_taynik_pda8_have")
		return true
	else
		return false
	end
end
function kostya_taynik_pda8_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda8", "out")
end

function t_inventory_box9()
  taynik_spawn.t_new_inventory9_1()
  local obj = alife():create("t_inventory_box9_2",vector():set(-108.54,0.61,-244.63),11031,3241)
  taynik_spawn.t_new_inventory9_3()
end
function kostya_taynik_pda9_have(task, objective)
	if db.actor:object("kostya_taynik_pda9_1") ~= nil and db.actor:object("kostya_taynik_pda9_2") ~= nil and db.actor:object("kostya_taynik_pda9_3") ~= nil then
		db.actor:give_info_portion("kostya_taynik_pda9_have")
		return true
	else
		return false
	end
end
function kostya_taynik_pda9_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda9_1", "out")
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda9_2", "out")
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda9_3", "out")
end

function t_inventory_box10()
  local obj = alife():create("t_inventory_box10_1",vector():set(-116.87435913086,4.8685846328735,-149.80033874512),89560,562)
  obj = alife():create("t_inventory_box10_2",vector():set(-26.37,-0.58,-25.53),280608,1593)
  obj = alife():create("t_inventory_box10_3",vector():set(27.953716278076,20.462240219116,684.33978271484),307284,208)
  obj = alife():create("t_inventory_box10_4",vector():set(106.7265625,13.199247360229,153.22033691406),272568,374)
  spawn_restrictor.kostya_taynik_pda10_sr1()
end
function kostya_taynik_pda10_have(task, objective)
	if db.actor:object("kostya_taynik_pda10_1") ~= nil and db.actor:object("kostya_taynik_pda10_2") ~= nil and db.actor:object("kostya_taynik_pda10_3") ~= nil and db.actor:object("kostya_taynik_pda10_4") ~= nil then
		db.actor:give_info_portion("kostya_taynik_pda10_have")
		return true
	else
		return false
	end
end
function kostya_taynik_pda10_done(first_speaker, second_speaker)
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda10_1", "out")
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda10_2", "out")
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda10_3", "out")
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda10_4", "out")
end

function t_inventory_box11()
  local obj = alife():create("t_inventory_box11_1",vector():set(192.18560791016,12.331077575684,101.35523986816),260351,2221)
  taynik_spawn.t_new_inventory11_2()
  obj = alife():create("t_inventory_box11_3",vector():set(6.5773458480835,8.061222076416,138.07514953613),109702,2147)
end
function kostya_taynik_pda11_have(task, objective)
	if db.actor:object("kostya_taynik_pda11_1") ~= nil and db.actor:object("kostya_taynik_pda11_2") ~= nil and db.actor:object("kostya_taynik_pda11_3") ~= nil then
		db.actor:give_info_portion("kostya_taynik_pda11_have")
		return true
	else
		return false
	end
end
function kostya_taynik_pda11_done(first_speaker, second_speaker)
  db.actor:give_info_portion("ktdt1")
  news_manager.send_tip(db.actor, "Найдена информация.", nil, nil, 20000)
  this.spawn_x_teleport1()
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda11_1", "out")
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda11_2", "out")
  dialogs.relocate_item_section(second_speaker, "kostya_taynik_pda11_3", "out")
end

function spawn_t_teleport1_1()
    local se_obj = alife():create("t_teleport1_1",vector():set(190.83657836914,2.7860803604126,217.42588806152),260274,2219)
	xr_logic.pstor_store(db.actor, "t_teleport1_1", se_obj.id)		  
end
function delete_t_teleport1_1(story_id)
	local obj_id = xr_logic.pstor_retrieve(db.actor, "t_teleport1_1", -1, true)
	local se_obj = alife() : object(obj_id)
if se_obj then
  alife():release(se_obj, true)
end
end
function spawn_t_teleport1_2()
    local se_obj = alife():create("t_teleport1_2",vector():set(23.953285217285,10.699913024902,162.15838623047),131398,2199)
	xr_logic.pstor_store(db.actor, "t_teleport1_2", se_obj.id)		  
end

function spawn_t_teleport4_1()
    local se_obj = alife():create("t_teleport4_1",vector():set(-50.95,-29.72,-139.41),796684,2897)
	xr_logic.pstor_store(db.actor, "t_teleport4_1", se_obj.id)		  
end

function spawn_x_teleport1()
    local se_obj = alife():create("x_teleport1",vector():set(9.4039793014526,11.447186470032,90.041458129883),114619,2142)
	xr_logic.pstor_store(db.actor, "x_teleport1", se_obj.id)
	spawn_restrictor.ktdt1_sr1()
end
function spawn_x_teleport2()
    local se_obj = alife():create("x_teleport2",vector():set(-15.461825370789,-3.8673331737518,-5.0735273361206),283384,1593)
	xr_logic.pstor_store(db.actor, "x_teleport2", se_obj.id)
	spawn_restrictor.ktdt2_sr1()
end
function spawn_x_teleport3()
    local se_obj = alife():create("x_teleport3",vector():set(47.420116424561,-2.4642562866211,-209.0924987793),63669,1469)
	xr_logic.pstor_store(db.actor, "x_teleport3", se_obj.id)
    se_obj = alife():create("x_teleport3_1",vector():set(-47.345569610596,0.74647736549377,-160.83731079102),16808,1490)
	xr_logic.pstor_store(db.actor, "x_teleport3_1", se_obj.id)
    se_obj = alife():create("x_teleport3_2",vector():set(-25.791805267334,0.7459944486618,-150.2300567627),16808,1490)
	xr_logic.pstor_store(db.actor, "x_teleport3_2", se_obj.id)
    se_obj = alife():create("x_teleport3_3",vector():set(-67.088394165039,1.2463047504425,-154.01571655273),15216,1490)
	xr_logic.pstor_store(db.actor, "x_teleport3_3", se_obj.id)
    se_obj = alife():create("x_inventory_box3",vector():set(-27.107929229736,0.74637401103973,-160.10646057129),16808,1490)
	spawn_restrictor.ktdt3_sr1()
end


function taynik_kostya2_call()
    if has_alife_info("kostya_sacharov_done") and has_alife_info("sahar_sumka_done") and has_alife_info("kostya_biznes1_done") then 
	  news_manager.send_tip(db.actor, "%c[255,160,160,160]".."КОСТЯ:".."\\n".."%c[255,255,128,128]Стрелок! Будешь в наших краях, заходи, есть кое-что интересное.".."".."\n", nil, nil, 30000)
	  -- Звуковое сопровождение
	  local snd_obj = xr_sound.get_safe_sound_object([[device\pda\pda_tip]])
      snd_obj:play_no_feedback(db.actor, sound_object.s2d, 0, vector(), 1.0)
	end
end

function esc_pda_have(task, objective)
if db.actor ~= nil then
return db.actor:object("kostya_pda") ~= nil
end
return false
end

function esc_pda_done(first_speaker, second_speaker)
dialogs.relocate_item_section(first_speaker, "kostya_pda", "out")
second_speaker:set_relation(game_object.friend, first_speaker) 
end

function esc_art_have(task, objective)
if db.actor ~= nil then
return db.actor:object("kostya_af_gold_fish") ~= nil
end
return false
end

function esc_art_done(first_speaker, second_speaker)
dialogs.relocate_item_section(second_speaker, "kostya_af_gold_fish", "out")
second_speaker:set_relation(game_object.friend, first_speaker) 
end


function esc_pda2_have(task, objective)
if db.actor ~= nil then
return db.actor:object("kostya_pda2") ~= nil
end
return false
end

function esc_pda2_done(first_speaker, second_speaker)
dialogs.relocate_item_section(second_speaker, "kostya_pda2", "out")
end


function esc_pda3_have(task, objective)
if db.actor ~= nil then
return db.actor:object("kostya_pda3") ~= nil
end
return false
end

function esc_pda3_done(first_speaker, second_speaker)
dialogs.relocate_item_section(second_speaker, "kostya_pda3", "out")
end


function esc_pda4_have(task, objective)
if db.actor ~= nil then
return db.actor:object("kostya_pda4") ~= nil
end
return false
end

function esc_pda4_done(first_speaker, second_speaker)
dialogs.relocate_item_section(second_speaker, "kostya_pda4", "out")
end


function esc_pda5_have(task, objective)
if db.actor ~= nil then
return db.actor:object("kostya_pda5") ~= nil
end
return false
end

function esc_pda5_done(first_speaker, second_speaker)
dialogs.relocate_item_section(second_speaker, "kostya_pda5", "out")
end


function esc_pda6_have(task, objective)
if db.actor ~= nil then
return db.actor:object("kostya_pda6") ~= nil
end
return false
end

function esc_pda6_done(first_speaker, second_speaker)
dialogs.relocate_item_section(second_speaker, "kostya_pda6", "out")
end


function esc_pda7_have(task, objective)
if db.actor ~= nil then
return db.actor:object("kostya_pda7") ~= nil
end
return false
end

function esc_pda7_done(first_speaker, second_speaker)
dialogs.relocate_item_section(second_speaker, "kostya_pda7", "out")
end


function esc_pda8_have(task, objective)
if db.actor ~= nil then
return db.actor:object("kostya_pda8") ~= nil
end
return false
end

function esc_pda8_done(first_speaker, second_speaker)
dialogs.relocate_item_section(second_speaker, "kostya_pda8", "out")
end


function esc_pda9_have(task, objective)
if db.actor ~= nil then
return db.actor:object("kostya_pda9") ~= nil
end
return false
end

function esc_pda9_done(first_speaker, second_speaker)
dialogs.relocate_item_section(second_speaker, "kostya_pda9", "out")
end


function sacharov_pda_have(task, objective)
if db.actor ~= nil then
return db.actor:object("pda_vasilyev") ~= nil
end
return false
end

function sacharov_pda_done(first_speaker, second_speaker)
	sak.out_item_namber("pda_vasilyev",1)
	news_manager.send_tip(db.actor, "Получена информация.", nil, nil, 30000)
end

function kostya_art2_have(task, objective)
if db.actor ~= nil then
return db.actor:object("af_dummy_battery") ~= nil
end
return false
end

function kostya_art2_done(first_speaker, second_speaker)
dialogs.relocate_item_section(second_speaker, "af_dummy_battery", "out")
end

function document_done(first_speaker, second_speaker)
	sak.out_item_namber("kostya_documents",1)
end

function kostya_teleport(first_speaker, second_speaker)
dialogs.relocate_item_section(second_speaker, "science_teleport", "in")
end

function kostya_teleport2(first_speaker, second_speaker)
dialogs.relocate_item_section(second_speaker, "science_teleport2", "in")
end

function kostya_teleport3(first_speaker, second_speaker)
dialogs.relocate_item_section(second_speaker, "science_teleport3", "in")
end

function kostya_teleport4(first_speaker, second_speaker)
dialogs.relocate_item_section(second_speaker, "device_teleport", "in")
end

function info_recieved()
	news_manager.send_tip(db.actor, "Получена информация", nil, nil, 10000)
end

-- Вероятности появления фраз в диалогах
function probability_05()
	return math.random() <= 0.05
end

function actor_has_money_100000()
  return db.actor:money()>=100000
end
function give_money_100000(t1,t2)
  local npc=t1
  if npc:id()==db.actor:id() then
    npc=t2
  end
  dialogs.relocate_money(npc,100000,"out")
end

function actor_has_money_40000()
  return db.actor:money()>=40000
end
function give_money_40000(t1,t2)
  local npc=t1
  if npc:id()==db.actor:id() then
    npc=t2
  end
  dialogs.relocate_money(npc,40000,"out")
end

function actor_has_money_20000()
  return db.actor:money()>=20000
end
function give_money_20000(t1,t2)
  local npc=t1
  if npc:id()==db.actor:id() then
    npc=t2
  end
  dialogs.relocate_money(npc,20000,"out")
end

function actor_out_money_190000()
	aem_manager.manage_money(190000, "out")
end
function actor_in_money_190000()
	aem_manager.manage_money(190000, "in")
end

function actor_has_money_200000()
  return db.actor:money() >= 200000
end
function actor_dont_has_money_200000()
  return db.actor:money() < 200000
end
function give_money_200000(t1,t2)
  local npc=t1
  if npc:id()==db.actor:id() then
    npc=t2
  end
  dialogs.relocate_money(npc,200000,"out")
end

function actor_has_money_20000()
  return db.actor:money() >= 20000
end
function actor_dont_has_money_20000()
  return db.actor:money() < 20000
end
function give_money_20000(t1,t2)
  local npc=t1
  if npc:id()==db.actor:id() then
    npc=t2
  end
  dialogs.relocate_money(npc,20000,"out")
end

function actor_has_money_25000()
  return db.actor:money() >= 25000
end
function actor_dont_has_money_25000()
  return db.actor:money() < 25000
end
function give_money_25000(t1,t2)
  local npc=t1
  if npc:id()==db.actor:id() then
    npc=t2
  end
  dialogs.relocate_money(npc,25000,"out")
end
